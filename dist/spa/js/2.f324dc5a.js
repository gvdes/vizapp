(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"0618":function(t,e,s){"use strict";var i=s("c84b"),a=s.n(i);a.a},1:function(t,e){},"19e8":function(t,e,s){"use strict";var i=s("31b8");e["a"]={join(t){return i["b"].post("/workpoint/join",t)},index(){return i["b"].get("/workpoints").then((t=>(console.log(t),t.data))).catch((t=>{console.log(t)}))}}},"1d6c":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-toolbar",{staticClass:"row justify-between items-center"},[s("span",[t.iconlauncher?s("q-btn",{attrs:{dense:"",rounded:"",flat:"",icon:"fab fa-atlassian fa-rotate-180"},on:{click:function(e){return t.$router.push("/")}}}):s("q-icon",{attrs:{name:"fab fa-atlassian fa-rotate-180",size:"25px"}})],1),s("span",{staticClass:"col text-center"},[s("span",[t._v(t._s(t.workin.workpoint.alias))]),s("br"),s("span",[t._v(t._s(t.title))])]),s("span",{staticClass:"text-right"},[s("q-btn",{attrs:{rounded:"",dense:"",color:t.sockstate?"green-13":""}},[s("q-img",{staticStyle:{height:"30px",width:"30px"},attrs:{src:t.picnick,"spinner-color":"white"}}),s("q-menu",{attrs:{dark:"","transition-show":"flip-right","transition-hide":"flip-left"}},[s("q-list",{staticClass:"exo text-grey-6",staticStyle:{"min-width":"150px"}},[s("q-item",{attrs:{clickable:""},on:{click:function(e){return t.$router.push("/perfil")}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"fas fa-user-astronaut"}})],1),s("q-item-section",[t._v("Hola "+t._s(t.session.me.nick))])],1),s("q-separator"),s("q-item",{attrs:{clickable:""},on:{click:t.sessionDestroy}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"meeting_room"}})],1),s("q-item-section",[t._v("Salir")])],1)],1)],1)],1)],1)])},a=[],r={name:"ToolbarAccount",props:{title:{type:String,default:""},iconlauncher:{type:Boolean,default:!0},sockstate:{type:Boolean,default:!1}},methods:{sessionDestroy(){this.$store.commit("Account/unsetsession"),this.$router.push("/acceso")}},computed:{session:{get(){return this.$store.state.Account.profile}},workin:{get(){return this.$store.state.Account.workin}},workpoints:{get(){return this.$store.state.Account.workpoints}},picnick(){return this.session.me.pictures?this.session.me.pictures:"https://www.iconfinder.com/data/icons/avatars-15/64/_Ninja-2-512.png"}}},o=r,n=s("2877"),d=s("65c6"),l=s("9c40"),c=s("0016"),u=s("068f"),p=s("4e73"),h=s("1c1c"),v=s("66e5"),g=s("4074"),m=s("eb85"),b=s("eebe"),x=s.n(b),_=Object(n["a"])(o,i,a,!1,null,null,null);e["a"]=_.exports;x()(_,"components",{QToolbar:d["a"],QBtn:l["a"],QIcon:c["a"],QImg:u["a"],QMenu:p["a"],QList:h["a"],QItem:v["a"],QItemSection:g["a"],QSeparator:m["a"]})},bd9f:function(t,e,s){"use strict";var i=s("31b8");e["a"]={index(){return i["b"].get("/requisition").then((t=>t.data)).catch((t=>{console.log(t)}))},create(t){return console.log("Creando pedido..."),i["b"].post("/requisition",t)},find(t){return console.log("traiendo "+t),i["b"].get("/requisition/"+t).then((t=>{let e=t.data;return console.log(e),e})).catch((t=>{console.log(t)}))},add(t){return console.log(t),i["b"].post("/requisition/add",t)},remove(t){return console.log(t),i["b"].post("/requisition/remove",t)},nextstep(t){return i["b"].post("/requisition/next",t)},dashboard(){return i["b"].get("/requisition/dashboard").then((t=>{let e=t.data;return e})).catch((t=>{console.log(t)}))},reprint(t){return i["b"].post("/requisition/reimpresion",t)}}},c84b:function(t,e,s){},fc40:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{class:t.ismobile?"":"q-pb-md overflow-hidden",style:t.ismobile?"":"max-width:100%;max-height:70vh;"},[s("q-header",{staticClass:"bg-darktransl0 text-grey-5 q-pa-sm"},[s("q-card",{staticClass:"bg-darkl1"},[s("toolbar-account",{attrs:{title:"Tablero de Pedidos",sockstate:t.appconnected}})],1)],1),t.ismobile?s("div",{staticClass:"q-px-sm"},[s("q-table",{attrs:{grid:"",dark:"",data:t.ordersdb,"row-key":"id",pagination:t.initpagination},scopedSlots:t._u([{key:"item",fn:function(e){return[s("div",{staticClass:"q-pa-xs col-xs-12 col-sm-6 col-md-4 text-grey-5"},[s("q-card",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"bg-darkl1",attrs:{clickable:""},on:{click:function(s){return t.showLog(e.row.id)}}},[s("q-card-section",[s("div",{staticClass:"row items-center"},[s("div",{staticClass:"col"},[s("div",{staticClass:"text-h4 text-white"},[t._v(t._s(e.row.id))]),s("div",{staticClass:"text-h6 text-light-blue"},[t._v(t._s(e.row.from.alias))]),s("div",{staticClass:"text-amber-13"},[t._v(t._s(e.row.notes))]),s("div",{staticClass:"q-pt-md text--2 text-uppercase text-grey-4"},[t._v(t._s(e.row.status.name))])]),s("div",{staticClass:"text-center self-end"},[s("div",[s("q-avatar",{attrs:{size:"70px"}},[s("img",{attrs:{src:t.buildlog(e.row,"avatar")}})])],1),s("div",[t._v(t._s(t.buildlog(e.row,"resp")))]),s("div",[s("span",{staticClass:"text-white text-bold"},[t._v(t._s(t.buildlog(e.row,"time")))])])])])])],1)],1)]}},{key:"bottom",fn:function(){},proxy:!0}],null,!1,3605897789)})],1):s("div",{staticClass:"row justify-between"},[s("div",{staticClass:"col q-px-sm"},[s("q-card",{staticClass:"bg-none"},[s("q-toolbar",{staticClass:"q-mb-sm text-green-13 bg-darkl1 text-uppercase text-thin text-h5"},[t._v("\n                        Levantando"),s("q-space"),t._v(t._s(t.orderTaking.length)+"\n                    ")],1)],1),s("q-scroll-area",{staticStyle:{height:"75vh","max-width":"100%"}},t._l(t.orderTaking,(function(e){return s("q-card",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.id,staticClass:"bg-darkl1 q-mb-sm",attrs:{clickable:""},on:{click:function(s){return t.showLog(e.id)}}},[s("q-card-section",[s("div",{staticClass:"row items-center"},[s("div",{staticClass:"col"},[s("div",{staticClass:"text-h4 text-white"},[t._v(t._s(e.id))]),s("div",{staticClass:"text-h6 text-light-blue"},[t._v(t._s(e.from.alias))]),s("div",{staticClass:"text-amber-13"},[t._v(t._s(e.notes))])]),s("div",{staticClass:"text-center self-end"},[s("div",[s("q-avatar",{attrs:{size:"70px"}},[s("img",{attrs:{src:t.buildlog(e,"avatar")}})])],1),s("div",[t._v(t._s(t.buildlog(e,"resp")))]),s("div",[s("span",{staticClass:"text-white text-bold"},[t._v(t._s(t.buildlog(e,"time")))])])])])])],1)})),1)],1),s("div",{staticClass:"col q-px-sm"},[s("q-card",{staticClass:"bg-darkl0"},[s("q-toolbar",{staticClass:"q-mb-sm text-green-13 bg-darkl1 text-uppercase text-thin text-h5"},[t._v("\n                        Por surtir"),s("q-space"),t._v(t._s(t.orderForSupply.length)+"\n                    ")],1)],1),s("q-scroll-area",{staticStyle:{height:"75vh","max-width":"100%"}},t._l(t.orderForSupply,(function(e){return s("q-card",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.id,staticClass:"bg-darkl1 q-mb-sm",attrs:{clickable:""},on:{click:function(s){return t.showLog(e.id)}}},[0==e.printed?s("q-banner",{staticClass:"text-white bg-red",attrs:{dense:""},scopedSlots:t._u([{key:"avatar",fn:function(){return[s("q-icon",{attrs:{name:"fas fa-exclamation-triangle",color:"white"}})]},proxy:!0}],null,!0)},[s("span",{staticClass:"text--1"},[t._v("Rayos!!, este pedido no logro imprimirse :(")])]):t._e(),s("q-card-section",[s("div",{staticClass:"row items-center"},[s("div",{staticClass:"col"},[s("div",{staticClass:"text-h4 text-white"},[t._v(t._s(e.id))]),s("div",{staticClass:"text-h6 text-light-blue"},[t._v(t._s(e.from.alias))]),s("div",{staticClass:"text-amber-13"},[t._v(t._s(e.notes))])]),s("div",{staticClass:"text-center self-end"},[s("div",[s("q-avatar",{attrs:{size:"70px"}},[s("img",{attrs:{src:t.buildlog(e,"avatar")}})])],1),s("div",[t._v(t._s(t.buildlog(e,"resp")))]),s("div",[s("span",{staticClass:"text-white text-bold"},[t._v(t._s(t.buildlog(e,"time")))])])])])])],1)})),1)],1),s("div",{staticClass:"col q-px-sm"},[s("q-card",{staticClass:"bg-darkl0"},[s("q-toolbar",{staticClass:"q-mb-sm text-green-13 bg-darkl1 text-uppercase text-thin text-h5"},[t._v("\n                        Surtiendo"),s("q-space"),t._v(t._s(t.orderSuppling.length)+"\n                    ")],1)],1),s("q-scroll-area",{staticStyle:{height:"75vh","max-width":"100%"}},t._l(t.orderSuppling,(function(e){return s("q-card",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.id,staticClass:"bg-darkl1 q-mb-sm",attrs:{clickable:""},on:{click:function(s){return t.showLog(e.id)}}},[s("q-card-section",[s("div",{staticClass:"row items-center"},[s("div",{staticClass:"col"},[s("div",{staticClass:"text-h4 text-white"},[t._v(t._s(e.id))]),s("div",{staticClass:"text-h6 text-light-blue"},[t._v(t._s(e.from.alias))]),s("div",{staticClass:"text-amber-13"},[t._v(t._s(e.notes))])]),s("div",{staticClass:"text-center self-end"},[s("div",[s("q-avatar",{attrs:{size:"70px"}},[s("img",{attrs:{src:t.buildlog(e,"avatar")}})])],1),s("div",[t._v(t._s(t.buildlog(e,"resp")))]),s("div",[s("span",{staticClass:"text-white text-bold"},[t._v(t._s(t.buildlog(e,"time")))])])])])])],1)})),1)],1),s("div",{staticClass:"col q-px-sm"},[s("q-card",{staticClass:"bg-darkl0"},[s("q-toolbar",{staticClass:"q-mb-sm text-green-13 bg-darkl1 text-uppercase text-thin text-h5"},[t._v("\n                        En camino"),s("q-space"),t._v(t._s(t.orderToArrive.length)+"\n                    ")],1)],1),s("q-scroll-area",{staticStyle:{height:"75vh","max-width":"100%"}},t._l(t.orderToArrive,(function(e){return s("q-card",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.id,staticClass:"bg-darkl1 q-mb-sm",attrs:{clickable:""},on:{click:function(s){return t.showLog(e.id)}}},[s("q-card-section",[s("div",{staticClass:"row items-center"},[s("div",{staticClass:"col"},[s("div",{staticClass:"text-h4 text-white"},[t._v(t._s(e.id))]),s("div",{staticClass:"text-h6 text-light-blue"},[t._v(t._s(e.from.alias))]),s("div",{staticClass:"text-amber-13"},[t._v(t._s(e.notes))])]),s("div",{staticClass:"text-center self-end"},[s("div",[s("q-avatar",{attrs:{size:"70px"}},[s("img",{attrs:{src:t.buildlog(e,"avatar")}})])],1),s("div",[t._v(t._s(t.buildlog(e,"resp")))]),s("div",[s("span",{staticClass:"text-white text-bold"},[t._v(t._s(t.buildlog(e,"time")))])])])])])],1)})),1)],1),s("div",{staticClass:"col q-px-sm"},[s("q-card",{staticClass:"bg-darkl0"},[s("q-toolbar",{staticClass:"q-mb-sm text-green-13 bg-darkl1 text-uppercase text-thin text-h5"},[t._v("\n                        Entregados"),s("q-space"),t._v(t._s(t.orderOk.length)+"\n                    ")],1)],1),s("q-scroll-area",{staticStyle:{height:"75vh","max-width":"100%"}},t._l(t.orderOk,(function(e){return s("q-card",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.id,staticClass:"bg-darkl1 q-mb-sm",attrs:{clickable:""},on:{click:function(s){return t.showLog(e.id)}}},[s("q-card-section",[s("div",{staticClass:"row items-center"},[s("div",{staticClass:"col"},[s("div",{staticClass:"text-h4 text-white"},[t._v(t._s(e.id))]),s("div",{staticClass:"text-h6 text-light-blue"},[t._v(t._s(e.from.alias))]),s("div",{staticClass:"text-amber-13"},[t._v(t._s(e.notes))])]),s("div",{staticClass:"text-center self-end"},[s("div",[s("q-avatar",{attrs:{size:"70px"}},[s("img",{attrs:{src:t.buildlog(e,"avatar")}})])],1),s("div",[t._v(t._s(t.buildlog(e,"resp")))]),s("div",[s("span",{staticClass:"text-white text-bold"},[t._v(t._s(t.buildlog(e,"time")))])])])])])],1)})),1)],1)]),s("q-dialog",{model:{value:t.wndLog.state,callback:function(e){t.$set(t.wndLog,"state",e)},expression:"wndLog.state"}},[t.wndLog.order?s("q-card",{staticClass:"exo bg-darkl0 text-grey-5",staticStyle:{width:"500px"}},[s("q-card-section",[s("div",{staticClass:"row text-white justify-between items-center"},[s("div",{staticClass:"text-h3"},[t._v(t._s(t.wndLog.order.from.alias)+" "+t._s(t.wndLog.order.id))]),s("div",{staticClass:"text-h6"},[s("div",[t._v(t._s(t.ordersize(t.wndLog.order.products)[0])+"m "+t._s(t.ordersize(t.wndLog.order.products)[1])+"p")]),t.wndLog.order?s("q-btn",{attrs:{icon:"print",flat:"",color:"green-13",loading:t.print.state,disable:t.print.state},on:{click:t.reprint}}):t._e()],1)]),s("q-timeline",{attrs:{dark:"",color:"green-13"}},t._l(t.wndLog.order.log,(function(e){return s("q-timeline-entry",{key:e.id,attrs:{subtitle:e.details.responsable,title:e.name}},[s("div",{staticClass:"row text-center"},[s("div",{staticClass:"col row items-center"},[s("q-icon",{attrs:{name:"fas fa-hourglass-start",color:"blue-grey-7"}}),s("span",{staticClass:"text-white q-px-sm"},[t._v(t._s(t.humantime(e.created_at)))])],1),s("div",{staticClass:"col row items-center"},[s("q-icon",{attrs:{name:"fas fa-hourglass-end",color:"blue-grey-7"}}),s("span",{staticClass:"text-white q-px-sm"},[t._v(t._s(e.updated_at==e.created_at?"--":t.humantime(e.updated_at)))])],1),s("div",{staticClass:"col row items-center"},[s("q-icon",{attrs:{name:"fas fa-stopwatch",color:"blue-grey-7"}}),s("span",{staticClass:"text-white q-px-sm"},[t._v(t._s(t.duration(e)))])],1)]),s("div",{staticClass:"text-right"},[2==t.wndLog.order.status.id&&2==e.id?s("div",{staticClass:"q-pt-md"},[s("q-btn",{attrs:{outline:"",color:"green-13",label:"iniciar surtido",disable:t.moving,loading:t.moving},on:{click:function(e){return t.changeState()}}})],1):t._e(),3==t.wndLog.order.status.id&&3==e.id?s("div",{staticClass:"q-pt-md"},[s("q-btn",{attrs:{outline:"",color:"purple-13",label:"Iniciar envio",disable:t.moving,loading:t.moving},on:{click:function(e){return t.changeState(5)}}})],1):t._e()])])})),1),9==t.wndLog.order.status.id?s("div",{staticClass:"text-h6 text-light-blue-13 text-center text-"},[t._v("\n                        Pedido completado en "+t._s(t.totalduration(t.wndLog.order.log))+"\n                    ")]):t._e()],1)],1):t._e()],1)],1)},a=[],r=(s("13d5"),s("e6cf"),s("bd4c")),o=s("bd9f"),n=(s("19e8"),s("1d6c")),d=s("8055"),l=s.n(d),c={components:{ToolbarAccount:n["a"]},data(){return{filtdash:{searcher:"",view:[],crude:null},vsocket:void 0,index:void 0,initpagination:{sortBy:"id",descending:!1,rowsPerPage:0},sounds:{creating:new Audio("sounds/creating.mp3"),created:new Audio("sounds/waiting.mp3"),moved:new Audio("sounds/moved.mp3"),removed:new Audio("sounds/removed.mp3")},wndLog:{state:!1,order:void 0},moving:!1,print:{state:!1}}},async beforeMount(){this.index=await o["a"].dashboard()},async mounted(){this.vsocket=await l()(this.$vsocket),this.vsocket.emit("dashboard_ready",this.profile),this.vsocket.on("joined_at_dashboard",(t=>{console.log(t)})),this.vsocket.on("creatingorder",(t=>{console.log("Se ha creado un pedido..."),console.log(t),this.ordersdb.unshift(t.order),this.sounds.creating.play()})),this.vsocket.on("using_order",(t=>{console.log("Se abrio una orden..."),console.log(t)})),this.vsocket.on("order_changestate",(t=>{console.log("Actualizando status a pedido"),console.log(t);let e=this.ordersdb.findIndex((e=>e.id==t.order.id));switch(this.ordersdb[e].log=t.order.log,this.ordersdb[e].status=t.order.status,this.ordersdb[e].products=t.order.products,this.ordersdb[e].printed=t.order.printed,t.state.id){case 2:this.sounds.created.play();break;case 10:this.sounds.removed.play();break;default:this.sounds.moved.play();break}}))},methods:{reprint(){console.log("reimprimiendo");let t={_requisition:this.wndLog.order.id};this.print.state=!0,o["a"].reprint(t).then((t=>{console.log(t),this.print.state=!1;let e=this.ordersdb.findIndex((t=>t.id==this.wndLog.order.id));this.ordersdb[e].printed+=1})).catch((t=>{console.log(t)}))},showLog(t){let e=this.ordersdb.findIndex((e=>e.id==t));this.wndLog.order=this.ordersdb[e],console.log(this.wndLog.order),this.wndLog.state=!0},changeState(t=null){this.moving=!0;let e=t||parseInt(this.wndLog.order.status.id)+1,s={id:this.wndLog.order.id,_status:e},i="",a={id:e,name:void 0};switch(e){case 3:console.log("Moviendo a surtiendo..."),a.name="Surtiendo",i="Surtido iniciado";break;case 5:console.log("Moviendo a En camino..."),a.name="En camino",i="Envio iniciado";break}o["a"].nextstep(s).then((t=>{let e=t.data;console.log(e),this.wndLog.state=!1,this.moving=!1;let s=this.ordersdb.findIndex((t=>t.id==e.order.id));this.ordersdb[s].log=e.order.log,this.ordersdb[s].status=e.order.status,this.$q.notify({message:i,color:"positive",icon:"done",position:"bottom-right"}),this.sounds.moved.play(),this.vsocket.emit("order_changestate",{state:a,profile:this.profile,order:this.ordersdb[s]})})).catch((t=>{console.log(t)}))}},computed:{profile:{get(){return this.$store.getters["Account/profile"]}},appconnected(){return!!this.vsocket&&this.vsocket.connected},ordersdb(){return this.index?this.index:[]},orderTaking(){return this.ordersdb.filter((t=>1==t.status.id))},orderForSupply(){return this.ordersdb.filter((t=>2==t.status.id))},orderSuppling(){return this.ordersdb.filter((t=>3==t.status.id))},orderCheckout(){return this.ordersdb.filter((t=>4==t.status.id))},orderToArrive(){return this.ordersdb.filter((t=>5==t.status.id))},orderArrived(){return this.ordersdb.filter((t=>6==t.status.id||7==t.status.id))},orderOk(){return this.ordersdb.filter((t=>9==t.status.id))},orderArchive(){return this.ordersdb.filter((t=>10==t.status.id||11==t.status.id))},noprinteds(){return this.orderForSupply.filter((t=>t.printed))},ismobile(){return this.$q.platform.is.mobile},buildlog(){return(t,e)=>{let s=t.log.findIndex((e=>t.status.id==e.id)),i=void 0;switch(e){case"time":let e=Date.parse(t.log[s].created_at);i=r["b"].formatDate(e,"hh:mm a");break;case"avatar":return"https://www.flaticon.es/svg/static/icons/svg/1674/1674229.svg";case"resp":return t.log[s].details.responsable}return i}},humantime(){return t=>{let e=Date.now(),s=Date.parse(t),i=r["b"].getDateDiff(e,s,"days");switch(i){case 0:return"Hoy, "+r["b"].formatDate(s,"hh:mm a");case 1:return"Ayer, "+r["b"].formatDate(s,"hh:mm a");default:return`Hace ${i} dias, `+r["b"].formatDate(s,"hh:mm a")}}},duration(){return t=>{let e=Date.parse(t.created_at),s=Date.parse(t.updated_at),i=r["b"].getDateDiff(s,e,"minutes");if(i<=59)return i+"m";{let t=parseFloat(i/60).toFixed(2).split(".");return`${t[0]}h ${t[1]}m`}}},ordersize(){return t=>{let e=t.length;if(e){let s=t.reduce(((t,e)=>parseInt(e.ordered.amount)+t),0);return[e,s]}return[0,0]}},totalduration(){return t=>{let e=Date.parse(t.filter((t=>1==t.id))[0].created_at),s=Date.parse(t.filter((t=>9==t.id))[0].created_at),i=r["b"].getDateDiff(s,e,"minutes");if(i<=59)return i+"m";{let t=parseFloat(i/60).toFixed(2).split(".");return`${t[0]}h ${t[1]}m`}}}}},u=c,p=(s("0618"),s("2877")),h=s("9989"),v=s("e359"),g=s("f09f"),m=s("27f9"),b=s("ddd8"),x=s("eaac"),_=s("a370"),f=s("cb32"),w=s("65c6"),q=s("2c91"),C=s("4983"),k=s("54e1"),y=s("0016"),S=s("9c40"),L=s("24e8"),Q=s("05eb"),A=s("74af"),D=s("714f"),$=s("eebe"),I=s.n($),T=Object(p["a"])(u,i,a,!1,null,"15644068",null);e["default"]=T.exports;I()(T,"components",{QPage:h["a"],QHeader:v["a"],QCard:g["a"],QInput:m["a"],QSelect:b["a"],QTable:x["a"],QCardSection:_["a"],QAvatar:f["a"],QToolbar:w["a"],QSpace:q["a"],QScrollArea:C["a"],QBanner:k["a"],QIcon:y["a"],QBtn:S["a"],QDialog:L["a"],QTimeline:Q["a"],QTimelineEntry:A["a"]}),I()(T,"directives",{Ripple:D["a"]})}}]);