(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{"5ed6":function(e,t,o){"use strict";var s=o("31b8");t["a"]={index(){return s["b"].get("/location/index").then((e=>e.data)).catch((e=>{console.log(e)}))},tree(e){return s["b"].get("/location/allSections",e)},warehouses(e){return s["b"].get("/location/cellers")},loadWarehouses(){return console.log("%cCargando Almacenes...","font-size:2em; color:purple;"),s["b"].get("/location/cellers").then((e=>(console.log(e),e.data.cellers))).catch((e=>{console.log(e)}))},loadSections(e){return console.log("Traiendo secciones"),s["b"].get("/location/sections",e)},product(e){return console.log(e),s["b"].get("/location/product",e)},toggle(e){return s["b"].post("/location/toggle",e)},create(e){return s["b"].post("/location/celler",e)},addSection(e){return console.log(e),s["b"].post("/location/section",e)},setminmax(e){return console.log(e),s["b"].post("/location/maximos",e)},existencesIndex(e){return console.log("Cargando index del modulo EXISTENCIAS.."),s["b"].post("/product/catalog",e).then((e=>e.data)).catch((e=>{console.log("===========ERROR==========="),console.log(e)}))},loadCats(e){return s["b"].post("/product/catalog",e)},getStocks(e){return s["b"].post("/location/stocks",e)},getFiltred(e){return console.log(e),s["b"].post("/product/catalog",e)}}},b293:function(e,t,o){"use strict";var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("q-select",{staticClass:"text-uppercase",attrs:{dark:"",dense:"",filled:"","fill-input":"",color:"green-13","use-input":"","hide-dropdown-icon":"","input-debounce":"0","option-value":"id","option-label":"code","hide-selected":"",behavior:"menu",autofocus:"",value:e.autocom.model,options:e.autocom.options,type:e.iptsearch.type},on:{filter:e.autocomplete,input:e.selItem},scopedSlots:e._u([{key:"no-option",fn:function(){return[o("q-item",[o("q-item-section",{staticClass:"text-grey"},[e._v("Sin coincidencias")])],1)]},proxy:!0},{key:"prepend",fn:function(){return[o("q-btn",{attrs:{type:"button",dense:"",size:"sm",flat:"",icon:e.iptsearch.icon,color:"grey-6"},on:{click:e.toogleIptSearch}})]},proxy:!0},{key:"option",fn:function(t){return[t.opt.status.id>1?o("div",e._b({staticClass:"text-grey-7 q-pa-sm"},"div",t.itemProps,!1),[o("div",{staticClass:"text-bold"},[e._v("\n                    "+e._s(t.opt.code)+" - "+e._s(t.opt.name)+"\n                    "),o("q-chip",{staticClass:"text--2",attrs:{color:"red","text-color":"white",icon:"warning",label:t.opt.status.name}})],1),o("div",{staticClass:"text--2",attrs:{caption:""}},[e._v(e._s(t.opt.description))])]):o("div",e._g(e._b({staticClass:"q-pa-sm q-mb-sm"},"div",t.itemProps,!1),t.itemEvents),[o("div",{staticClass:"text-body1 text-bold"},[e._v("\n                    "+e._s(t.opt.code)+" - "+e._s(t.opt.name)+"\n                ")]),o("div",{staticClass:"text--2",attrs:{caption:""}},[e._v(e._s(t.opt.description))])])]}}]),model:{value:e.autocom.model,callback:function(t){e.$set(e.autocom,"model",t)},expression:"autocom.model"}})],1)},a=[],n=(o("498a"),o("f7cb")),i={props:{checkState:{default:!1,type:Boolean},image:{default:!1,type:Boolean}},data(){return{autocom:{model:null,options:void 0},iptsearch:{processing:!1,type:"text",icon:"fas fa-hashtag"}}},methods:{autocomplete(e,t,o){let s={params:{code:e.trim()}};n["a"].autocomplete(s).then((e=>{let o=e.data;t((()=>{this.autocom.options=o}))})).catch((e=>{console.log(e)}))},toogleIptSearch(){switch(this.iptsearch.type){case"text":this.iptsearch.type="number",this.iptsearch.icon="fas fa-font";break;case"number":this.iptsearch.type="text",this.iptsearch.icon="fas fa-hashtag";break}this.$refs.iptsearch.focus()},selItem(e){this.$emit("input",e),setTimeout((()=>{this.autocom.model=null}),100)}}},r=i,c=o("2877"),l=o("ddd8"),d=o("66e5"),u=o("4074"),p=o("9c40"),h=o("b047"),g=o("eebe"),b=o.n(g),m=Object(c["a"])(r,s,a,!1,null,null,null);t["a"]=m.exports;b()(m,"components",{QSelect:l["a"],QItem:d["a"],QItemSection:u["a"],QBtn:p["a"],QChip:h["a"]})},c4e4:function(e,t,o){"use strict";var s=o("31b8");t["a"]={join(e){return s["b"].get("/workpoint/join")},get(e){return s["b"].post("account/users",e)}}},c738:function(e,t,o){"use strict";o.r(t);var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("q-page",{attrs:{padding:""}},[o("q-header",{staticClass:"bg-darkl1"},[o("q-toolbar",[o("q-btn",{attrs:{flat:"",rounded:"",dense:"",icon:"keyboard_backspace",color:"white"},on:{click:function(t){return e.$router.push("/almacen/contador")}}}),e._v("\n            Configuracion de Inventario "+e._s(this.$route.params.id)+"\n        ")],1)],1),o("div",{staticClass:"q-mb-xl q-pb-md"},[e.data?[o("q-card",{staticClass:"bg-darkl1 exo"},[o("q-card-section",[e._v("\n                    Creacion: "+e._s(e.data.inventory.created_at)),o("br"),e._v("\n                    Por: "+e._s(e.data.inventory.created_by.names)+" "+e._s(e.data.inventory.created_by.surname_pat)+" [ "+e._s(e.data.inventory.created_by.nick)+" ]"),o("br"),e._v("\n                    Estado: "+e._s(e.data.inventory.status.name)+"\n                ")])],1),o("q-card",{staticClass:"bg-darkl1 exo q-mt-sm"},[o("q-card-section",[o("div",[e._v("Responsables [ "+e._s(e.group.length)+" ]")])]),o("q-separator"),o("q-card-section",[o("q-scroll-area",{staticStyle:{height:"300px","max-width":"100%"}},[o("q-list",e._l(e.natAccounts,(function(t){return o("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.id,attrs:{tag:"label"}},[o("q-item-section",{attrs:{avatar:""}},[o("q-checkbox",{attrs:{disable:1!=e.data.inventory.status.id,dark:"",val:t.id,color:"green-13"},on:{input:function(o){return e.toggleReponsable(t.id)}},model:{value:e.group,callback:function(t){e.group=t},expression:"group"}})],1),o("q-item-section",[o("q-item-label",[o("span",{staticClass:"text-grey-6"},[e._v(e._s(t.names+" "+t.surname_pat))]),o("br"),e._v("\n                                        [ "+e._s(t.nick.toLowerCase())+" ]\n                                    ")])],1)],1)})),1)],1)],1)],1),o("q-card",{staticClass:"bg-darkl1 exo q-mt-sm"},[o("q-card-section",[o("div",{staticClass:"row items-start"},[o("div",{staticClass:"col"},[e._v("\n                            Productos [ "+e._s(e.listProducts.length)+" ]\n                        ")]),1==e.data.inventory.status.id?o("div",{staticClass:"col"},[o("q-select",{attrs:{dark:"",dense:"",flat:"",color:"green-13",label:"Agregar por...","stack-label":"",options:e.optsAddProds},on:{input:e.modeAddChanged},model:{value:e.modeAdd,callback:function(t){e.modeAdd=t},expression:"modeAdd"}})],1):e._e()])]),o("q-separator"),e.modeAdd?o("q-card-section",[1==e.modeAdd.value?o("div"):e._e(),2==e.modeAdd.value?o("div",[o("div",{staticClass:"row q-gutter-md"},[o("q-select",{staticClass:"col-xs-4 col-sm-2",attrs:{dark:"",color:"green-13",label:"Almacen","option-value":"id","option-label":"name",options:e.warehouses.options},on:{input:e.setWarehouse},model:{value:e.warehouses.selected,callback:function(t){e.$set(e.warehouses,"selected",t)},expression:"warehouses.selected"}}),e._l(e.warehouses.sections,(function(t,s){return o("q-select",{key:s,staticClass:"col-xs col-sm-1",attrs:{dark:"",color:"amber-13",options:e.warehouses.sections[s]},on:{input:function(t){return e.loadSections(e.warehouses.sectModels[s],s)}},model:{value:e.warehouses.sectModels[s],callback:function(t){e.$set(e.warehouses.sectModels,s,t)},expression:"warehouses.sectModels[idx]"}})})),e.warehouses.loading?[o("q-spinner-dots",{staticClass:"self-center",attrs:{size:"md",color:"green-13"}})]:e._e()],2)]):e._e(),3==e.modeAdd.value?o("div",[o("ProductAutocomplete")],1):e._e()]):e._e(),o("q-card-section",[o("q-table",{attrs:{dark:"",flat:"","card-class":"bg-none",data:e.listProducts,columns:e.tableProducts.columns},scopedSlots:e._u([{key:"body",fn:function(t){return[o("q-tr",{attrs:{props:t}},[o("q-td",{key:"id",attrs:{props:t}},[e._v(e._s(t.row.id))]),o("q-td",{key:"code",attrs:{props:t}},[e._v(e._s(t.row.code))]),o("q-td",{key:"locations",attrs:{props:t}},[e._v("\n                                    [ "+e._s(t.row.locations.length)+" ]\n                                    "),e._l(t.row.locations,(function(t,s){return o("span",{key:s},[e._v(e._s(t.path))])}))],2)],1)]}}],null,!1,3762135590)})],1)],1)]:e._e()],2),o("q-page-sticky",{attrs:{position:"bottom-left",offset:[10,10]}},[e.trydiscard?[o("q-btn",{attrs:{rounded:"","no-caps":"",color:"primary",icon:"close",label:"No Eliminar"},on:{click:function(t){e.trydiscard=!1}}}),o("q-btn",{attrs:{rounded:"","no-caps":"",color:"negative",label:"Â¡Confirmar Eliminacion de Inventario!"},on:{click:function(t){return e.nextStep(4)}}})]:o("q-btn",{attrs:{rounded:"","no-caps":"",color:"orange-14",icon:"delete",label:"Eliminar"},on:{click:function(t){e.trydiscard=!0}}})],2),e.canStart&&!e.trydiscard?o("q-page-sticky",{attrs:{position:"bottom-right",offset:[10,10]}},[o("q-btn",{attrs:{rounded:"","no-caps":"",color:"primary",icon:"fas fa-play-circle",label:"Iniciar"},on:{click:e.start}})],1):e._e()],1)},a=[],n=(o("a434"),o("e6cf"),o("e0df")),i=o("5ed6"),r=o("c4e4"),c=o("b293"),l={components:{ProductAutocomplete:c["a"]},data(){return{data:null,natAccounts:null,trydiscard:!1,group:[],optsAddProds:[{label:"Categorias",value:1},{label:"Ubicacion",value:2},{label:"Codigo",value:3}],modeAdd:null,listProducts:[],warehouses:{selected:null,options:[],sections:[],sectModels:[],loading:!1},filtrator:{paginate:null,_category:null,_location:null,check_stock:!1,with_stock:!1,_status:null},tableProducts:{columns:[{name:"id",align:"left",label:"ID",field:e=>e.id,sortable:!0},{name:"code",align:"left",label:"Codigo",field:e=>e.code,sortable:!0},{name:"locations",align:"center",label:"Ubicaciones",field:e=>e.locations.length,sortable:!0}]}}},async beforeMount(){this.$store.commit("Layout/hideToolbarModule"),this.data=await n["a"].find(this.$route.params.id),console.log(this.data),this.listProducts=this.data.inventory.products,this.getAccounts()},methods:{getAccounts(){r["a"].get({_rol:[7]}).then((e=>{console.log(e.data),this.natAccounts=e.data.map((e=>(this.data.inventory.responsables.forEach((t=>{t.id==e.id&&this.group.push(e.id)})),e)))})).catch((e=>{console.log(e)}))},toggleReponsable(e){let t={_responsable:e,_inventory:this.$route.params.id};n["a"].toggleReponsable(t).then((e=>{console.log(e.data),console.log(this.group)})).catch((e=>{console.log(e)}))},setWarehouse(){this.warehouses.loading=!0,this.warehouses.sections=[];let e={params:{_celler:this.warehouses.selected.id,products:!1}};console.log("Obteniendo secci0ones del almacen "+this.warehouses.selected.name),i["a"].loadSections(e).then((e=>{let t=e.data.sections.map((e=>({label:e.alias,value:e.id})));this.warehouses.sections.push(t),this.warehouses.sectModels.push({label:"Seleccione",value:null}),this.listProducts=e.data.products.data,this.warehouses.loading=!1})).catch((e=>{console.log(e)}))},loadSections(e,t){this.warehouses.loading=!0,console.log(this.warehouses.sections),console.log(this.warehouses.sectModels),this.warehouses.sections.splice(t+1),this.warehouses.sectModels.splice(t+1);let o={params:{_section:e.value,products:!1}};i["a"].loadSections(o).then((e=>{let t=e.data.sections.sections;if(t.length>0){let e=t.map((e=>({label:e.alias,value:e.id})));this.warehouses.sections.push(e),this.warehouses.sectModels.push({label:"Seleccione",value:null})}else console.log("Sin mas subsecciones por cargar!!");this.listProducts=e.data.products.data,this.warehouses.loading=!1})).catch((e=>{console.log(e)}))},async modeAddChanged(){switch(this.modeAdd.value){case 1:console.log("Modo Categoria Activado!!");break;case 2:console.log("Modo Ubicacion Activado!!"),this.warehouses.options=await i["a"].loadWarehouses();break;case 3:console.log("Modo Codigo Activado!!");break}},discard(){},start(){console.log("Iniciando ");let e=this.listProducts.map((e=>e.id));console.log(e);let t={_products:e,_inventory:this.data.inventory.id,settings:this.settings};console.log(t),this.$q.loading.show({message:"Aplicando Configuracion, espera..."}),n["a"].addProducts(t).then((e=>{this.nextStep()})).catch((e=>{console.log(e)}))},nextStep(e,t){let o=this.data.inventory.status,s="";console.log("Estatus Actual: "+o.id);let a=e||o.id+1;switch(a){case 2:s="Iniciando Inventario, espera...";break;case 3:s="Cerrando Inventario, esperaa..";break;case 4:s="Eliminando Inventario, espera...";break}this.$q.loading.show({message:s});let i={_inventory:this.data.inventory.id,_status:a};console.log("Cambiando status"),console.log(i),n["a"].nextStep(i).then((e=>{let t=e.data;console.log(t),this.data.inventory.status=t.order.status,this.notifyChangeState(t),this.$q.loading.hide()})).catch((e=>{console.log(e)}))},notifyChangeState(e){let t=e.order.status.id;switch(t){case 2:this.$q.notify({icon:"done",color:"positive",message:"El inventario ya puede realizarse!!",timeout:1200}),this.$q.loading.show(),setTimeout((()=>{this.$router.push("/almacen/contador/"+e.order.id),this.$q.loading.hide()}),1500);break;case 3:msgnewState="Cerrando Inventario, esperaa..";break;case 4:this.$q.notify({icon:"done",color:"positive",message:"El inventario ha sido eliminado!"}),this.$router.push("/almacen/contador");break}}},beforeDestroy(){this.$store.commit("Layout/showToolbarModule")},computed:{settings(){let e=new Object;if(this.data)switch(e.type=this.modeAdd,e.type.value){case 2:e.warehouse={id:this.warehouses.selected.id,name:this.warehouses.selected.name},e.path=this.fullpath;break;default:break}return e},fullpath(){let e="";return this.warehouses.sectModels.forEach(((t,o,s)=>{t.value&&(e+=0==o?""+t.label:"-"+t.label)})),e},auths(){return this.$store.getters["Account/moduleauths"]},profile(){return this.$store.getters["Account/profile"]},canStart(){return this.listProducts.length&&this.group.length}}},d=l,u=o("2877"),p=o("9989"),h=o("e359"),g=o("65c6"),b=o("9c40"),m=o("f09f"),v=o("a370"),f=o("eb85"),y=o("4983"),_=o("1c1c"),w=o("66e5"),k=o("4074"),q=o("8f8e"),x=o("0016"),C=o("0170"),S=o("ddd8"),A=o("8380"),Q=o("eaac"),$=o("bd08"),I=o("db86"),P=o("de5e"),M=o("714f"),E=o("eebe"),T=o.n(E),R=Object(u["a"])(d,s,a,!1,null,null,null);t["default"]=R.exports;T()(R,"components",{QPage:p["a"],QHeader:h["a"],QToolbar:g["a"],QBtn:b["a"],QCard:m["a"],QCardSection:v["a"],QSeparator:f["a"],QScrollArea:y["a"],QList:_["a"],QItem:w["a"],QItemSection:k["a"],QCheckbox:q["a"],QIcon:x["a"],QItemLabel:C["a"],QSelect:S["a"],QSpinnerDots:A["a"],QTable:Q["a"],QTr:$["a"],QTd:I["a"],QPageSticky:P["a"]}),T()(R,"directives",{Ripple:M["a"]})},e0df:function(e,t,o){"use strict";var s=o("31b8");t["a"]={index(){return s["b"].get("inventory").then((e=>e.data)).catch((e=>{console.log(e)}))},find(e){return s["b"].get("inventory/"+e).then((e=>e.data)).catch((e=>{console.log(e)}))},create(e){return s["b"].post("inventory",e)},toggleReponsable(e){return s["b"].post("inventory/responsable",e)},addProducts(e){return s["b"].post("inventory/add",e)},nextStep(e){return s["b"].post("inventory/next",e)},rowCount(e){return s["b"].post("inventory/value",e)}}},f7cb:function(e,t,o){"use strict";var s=o("31b8");t["a"]={autocomplete(e){return s["b"].get("/product/autocomplete",e)},getMassive(e){return s["b"].post("/product/getMassive",e)},labelStates(){return s["b"].get("/product/getStatus").then((e=>e.data.status)).catch((e=>{console.log(e)}))},updateState(e){return s["b"].post("/product/updateStatus",e)},products(e){return s["b"].post("product",e)}}}}]);