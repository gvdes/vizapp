(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[27],{a458:function(e,r,t){"use strict";t.r(r);var o=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("q-page",[t("OrdersList",{attrs:{orders:e.orders},on:{clicked:e.orderclicked}}),t("q-dialog",{attrs:{position:"bottom"},model:{value:e.wndPrinters.state,callback:function(r){e.$set(e.wndPrinters,"state",r)},expression:"wndPrinters.state"}},[t("PrinterSelect",{attrs:{options:e.printers},on:{clicked:e.reprint}})],1)],1)},s=[],i=t("5542"),n=t("bd4c"),a=t("6d5d"),d=t("a1a1"),c={name:"PreventaWarehouse",components:{OrdersList:a["a"],PrinterSelect:d["a"]},data(){return{wndPrinters:{state:!1},orderselected:null,printerselected:null,socket:this.$sktPreventa}},beforeMount(){this.$store.commit("Preventa/setHeaderTitle","Preventa | Surtido"),this.socket.emit("join",{profile:this.profile,workpoint:this.workin.workpoint,room:"warehouse"}),this.socket.on("order_changestate",(e=>this.skt_add_update_order(e)))},methods:{skt_add_update_order(e){console.log(e);let r=e.order;console.log(r);let t=this.orders.findIndex((e=>{e.id,r.id}));t>=0?console.log(`%cActualizar la orden ${r.id}...`,"background:#7158e2;color:#fffa65;border-radius:10px;padding:8px;"):(console.log(`%cAgregar la orden ${r.id}...`,"background:#7158e2;color:#fffa65;border-radius:10px;padding:8px;"),this.$store.commit("Preventa/newOrder",r))},orderclicked(e){this.orderselected=e,this.wndPrinters.state=!0},async reprint(e){console.log(e),this.printerselected=e,this.$q.loading.show({message:"Reimprimiendo..."});let r={_order:this.orderselected.id,_printer:e.id},t=await i["a"].reprint(r);t.err?this.$q.notify({message:t.err,color:"negative",icon:"fas fa-exclamation-triangle"}):(this.$q.loading.hide(),this.wndPrinters.state=!1,this.$q.notify({message:"Impresion correcta.",color:"positive",icon:"done"}))}},beforeDestroy(){this.socket.emit("unjoin",{profile:this.profile,workpoint:this.workin.workpoint,room:"warehouse"})},computed:{orders(){return this.$store.getters["Preventa/OrdersWarehouse"]},profile(){return this.$store.getters["Account/profile"]},workin(){return this.$store.getters["Account/workin"]},printers(){return this.$store.getters["Preventa/printersWarehouse"]},humantime(){return e=>{let r=Date.now(),t=Date.parse(e),o=n["b"].getDateDiff(r,t,"days");switch(o){case 0:return n["b"].formatDate(t,"hh:mm a");case 1:return"Ayer, "+n["b"].formatDate(t,"hh:mm a");default:return`Hace ${o} dias, `+n["b"].formatDate(t,"hh:mm a")}}}}},l=c,h=t("2877"),p=t("9989"),u=t("24e8"),m=t("eebe"),f=t.n(m),g=Object(h["a"])(l,o,s,!1,null,null,null);r["default"]=g.exports;f()(g,"components",{QPage:p["a"],QDialog:u["a"]})}}]);