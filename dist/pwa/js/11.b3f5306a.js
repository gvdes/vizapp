(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{1:function(e,t){},"1d6c":function(e,t,o){"use strict";var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("q-toolbar",{staticClass:"row justify-between items-center"},[o("span",[e.iconlauncher?o("q-btn",{attrs:{dense:"",rounded:"",flat:"",icon:"fab fa-atlassian fa-rotate-180"},on:{click:function(t){return e.$router.push("/")}}}):o("q-icon",{attrs:{name:"fab fa-atlassian fa-rotate-180",size:"25px"}})],1),o("span",{staticClass:"col text-center"},[o("span",[e._v(e._s(e.workin.workpoint.alias))]),o("br"),o("span",[e._v(e._s(e.title))])]),o("span",{staticClass:"text-right"},[o("q-btn",{attrs:{rounded:"",dense:"",color:e.sockstate?"green-13":""}},[o("q-img",{staticStyle:{height:"30px",width:"30px"},attrs:{src:e.picnick,"spinner-color":"white"}}),o("q-menu",{attrs:{"transition-show":"flip-right","transition-hide":"flip-left"}},[o("q-list",{staticClass:"text-grey-8 exo",staticStyle:{"min-width":"150px"}},[o("q-item",[o("q-item-section",[e._v("Hola "+e._s(e.session.me.nick))])],1),o("q-separator"),o("q-item",{attrs:{clickable:""},on:{click:e.sessionDestroy}},[o("q-item-section",[e._v("Salir")])],1)],1)],1)],1)],1)])},a=[],r={name:"ToolbarAccount",props:{title:{type:String,required:!0},iconlauncher:{type:Boolean,default:!0},sockstate:{type:Boolean,default:!1}},methods:{sessionDestroy(){this.$store.commit("Account/unsetsession"),this.$router.push("/acceso")}},computed:{session:{get(){return this.$store.state.Account.profile}},workin:{get(){return this.$store.state.Account.workin}},workpoints:{get(){return this.$store.state.Account.workpoints}},picnick(){return this.session.me.pictures?this.session.me.pictures:"https://www.iconfinder.com/data/icons/avatars-15/64/_Ninja-2-512.png"}}},n=r,i=o("2877"),d=o("65c6"),l=o("9c40"),c=o("0016"),u=o("068f"),p=o("4e73"),h=o("1c1c"),g=o("66e5"),b=o("4074"),m=o("eb85"),f=o("eebe"),w=o.n(f),k=Object(i["a"])(n,s,a,!1,null,null,null);t["a"]=k.exports;w()(k,"components",{QToolbar:d["a"],QBtn:l["a"],QIcon:c["a"],QImg:u["a"],QMenu:p["a"],QList:h["a"],QItem:g["a"],QItemSection:b["a"],QSeparator:m["a"]})},bd9f:function(e,t,o){"use strict";var s=o("31b8");t["a"]={index(){return s["b"].get("/requisition").then((e=>e.data)).catch((e=>{console.log(e)}))},create(e){return console.log("Creando pedido..."),s["b"].post("/requisition",e)},find(e){return console.log("traiendo "+e),s["b"].get("/requisition/"+e).then((e=>{let t=e.data;return console.log(t),t})).catch((e=>{console.log(e)}))},add(e){return console.log(e),s["b"].post("/requisition/add",e)},remove(e){return console.log(e),s["b"].post("/requisition/remove",e)},nextstep(e){return s["b"].post("/requisition/next",e)},dashboard(){return s["b"].get("/requisition/dashboard").then((e=>{let t=e.data;return t})).catch((e=>{console.log(e)}))},reprint(e){return s["b"].post("/requisition/reimpresion",e)}}},f673:function(e,t,o){"use strict";o.r(t);var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("q-page",{attrs:{padding:""}},[o("q-header",{staticClass:"bg-darkl0 text-grey-5 q-pa-sm"},[o("q-card",{staticClass:"bg-darkl1"},[o("toolbar-account",{attrs:{title:"Resurtido",sockstate:e.appconnected}})],1)],1),o("div",[o("q-table",{attrs:{dark:"",data:e.ordersday,"table-header-class":"text-green-13","card-class":"bg-darkl1 text-grey-6","row-key":"id",columns:e.tableOrders.columns,pagination:e.initpagination},scopedSlots:e._u([{key:"body",fn:function(t){return[o("q-tr",{attrs:{props:t},on:{click:function(o){return e.open(t.row.id)}}},[o("q-td",{key:"id",attrs:{props:t}},[e._v("\n\t\t\t\t\t\t\t"+e._s(t.row.id)+"\n\t\t\t\t\t\t")]),o("q-td",{key:"state",attrs:{props:t}},[o("div",[e._v(e._s(e.labelstate(t.row)))]),o("div",[e._v(e._s(e.timestate(t.row)))])]),o("q-td",{key:"size",attrs:{props:t}},[e._v("\n\t\t\t\t\t\t\t"+e._s(e.ordersize(t.row.products))+"\n\t\t\t\t\t\t")])],1)]}}])})],1),o("q-dialog",{attrs:{position:"bottom"},model:{value:e.wndSetOrder.state,callback:function(t){e.$set(e.wndSetOrder,"state",t)},expression:"wndSetOrder.state"}},[o("q-card",{staticClass:"bg-darkl0 text-grey-6 exo"},[o("q-toolbar",{staticClass:"text-white"},[e._v("Nuevo Pedido")]),o("q-card-section",[o("div",{staticClass:"row q-gutter-md"},[o("q-select",{staticClass:"col",attrs:{dark:"",color:"green-13",label:"Tipo",options:e.comboreqstypes,disable:1==e.comboreqstypes.length},model:{value:e.neworder.type,callback:function(t){e.$set(e.neworder,"type",t)},expression:"neworder.type"}}),o("q-select",{staticClass:"col",attrs:{dark:"",color:"green-13",label:"Destino",options:e.combowkps},model:{value:e.neworder.dest,callback:function(t){e.$set(e.neworder,"dest",t)},expression:"neworder.dest"}})],1),o("q-input",{attrs:{dark:"",color:"green-13",label:"notas"},model:{value:e.neworder.notes,callback:function(t){e.$set(e.neworder,"notes",t)},expression:"neworder.notes"}})],1),o("q-card-actions",{attrs:{align:"right"}},[o("q-btn",{staticClass:"bg-darkl1 shadow-1",attrs:{rounded:"",flat:"",color:"green-13",icon:"done",loading:e.wndSetOrder.creating,disable:e.wndSetOrder.creating},on:{click:e.tryCreate}})],1)],1)],1),o("q-page-sticky",{attrs:{position:"bottom-right",offset:[10,5]}},[o("q-btn",{staticClass:"bg-darkl1 shadow-1",attrs:{rounded:"",flat:"",color:"green-13",icon:"add"},on:{click:function(t){e.wndSetOrder.state=!0}}})],1)],1)},a=[],r=(o("13d5"),o("e6cf"),o("bd4c")),n=o("bd9f"),i=o("1d6c"),d=o("8055"),l=o.n(d),c=o("981c"),u={components:{ToolbarAccount:i["a"]},data(){return{vsocket:void 0,initpagination:{sortBy:"id",descending:!1,page:1,rowsPerPage:20},status:[],index:void 0,tableOrders:{columns:[{name:"id",align:"left",label:"ID"},{name:"state",align:"left",label:"Estado"},{name:"size",align:"center",label:"Contenido"}],data:void 0},wndSetOrder:{state:!1,creating:!1},neworder:{notes:"",type:{label:"Manual",value:1},dest:{label:"CEDISSAP",value:1}},sounds:{moved:new Audio("sounds/moved.mp3")}}},async beforeMount(){this.index=await this.loadIndex(),this.tableOrders.data=this.index.requisitions},async mounted(){this.vsocket=await l()(this.$vsocket),this.vsocket.emit("joinme_to_dashboard",this.profile),this.vsocket.on("dashboard_ready",(e=>{console.log("DASHBOARD esta disponible..."),console.log(e)})),this.vsocket.on("order_changestate",(e=>{console.log("Se ha cambiado el status a un pedido... "),console.log(e);let t=this.ordersday.findIndex((t=>t.id==e.order.id));t?(console.log("... y aqui esta"),this.ordersday[t].log=e.order.log,this.ordersday[t].status=e.order.status,this.sounds.moved.play()):console.log("... pero no esta aqui")}))},methods:{loadIndex(){return n["a"].index()},open(e){console.log("editar "+e),this.$router.push("/pedidos/"+e)},tryCreate(){console.log("Creando pedido!!");let e=new Object;e._workpoint_to=this.neworder.dest.value,e._type=this.neworder.type.value,e.notes=this.neworder.notes,2==this.neworder.type.value?this.$q.loading.show({spinner:c["a"],spinnerColor:"green-13",message:"Tu pedido se esta generando, por favor espera mientras consultamos existencias"}):this.wndSetOrder.creating=!0,n["a"].create(e).then((e=>{let t=e.data;console.log(t),this.$q.loading.hide(),this.wndSetOrder.creating=!1,this.wndSetOrder.state=!1,this.tableOrders.data.unshift(t.order),this.$q.notify({message:`Pedido ${t.order.id} creado!`,color:"positive",position:"center",timeout:1500}),this.vsocket.emit("creatingorder",{profile:this.profile,order:t.order}),this.$router.push("/pedidos/"+t.order.id)})).catch((e=>{console.log(e),this.$q.notify({message:"Rayos!!, esto no ha funcionado!",icon:"bug",color:"negative"})}))}},computed:{profile:{get(){return this.$store.getters["Account/profile"]}},appconnected(){return!!this.vsocket&&this.vsocket.connected},combowkps(){return this.index?this.index.workpoints.map((e=>({label:e.alias,value:e.id}))):[]},comboreqstypes(){return this.index?this.index.types.map((e=>({label:e.name,value:e.id}))):[]},ordersday(){return this.tableOrders.data?this.tableOrders.data:[]},labelstate(){return e=>{let t=e.log.findIndex((t=>t.id==e.status.id));return e.log[t].name}},timestate(){return e=>{let t=e.log.findIndex((t=>t.id==e.status.id)),o=e.log[t].created_at;return this.humantime(o)}},humantime(){return e=>{let t=Date.now(),o=Date.parse(e),s=r["a"].getDateDiff(t,o,"days");switch(s){case 0:return"Hoy a las "+r["a"].formatDate(o,"hh:mm a");case 1:return"Ayer a las "+r["a"].formatDate(o,"hh:mm a");default:return`Hace ${s} dias, a las `+r["a"].formatDate(o,"hh:mm a")}}},ordersize(){return e=>{let t=e.length;if(t){let o=e.reduce(((e,t)=>t.ordered.amount+e),0);return`M:${t}, P:${o}`}return"--"}}}},p=u,h=o("2877"),g=o("9989"),b=o("e359"),m=o("f09f"),f=o("eaac"),w=o("bd08"),k=o("db86"),q=o("24e8"),v=o("65c6"),y=o("a370"),x=o("ddd8"),_=o("27f9"),S=o("4b7e"),$=o("9c40"),C=o("de5e"),Q=o("eebe"),O=o.n(Q),D=Object(h["a"])(p,s,a,!1,null,null,null);t["default"]=D.exports;O()(D,"components",{QPage:g["a"],QHeader:b["a"],QCard:m["a"],QTable:f["a"],QTr:w["a"],QTd:k["a"],QDialog:q["a"],QToolbar:v["a"],QCardSection:y["a"],QSelect:x["a"],QInput:_["a"],QCardActions:S["a"],QBtn:$["a"],QPageSticky:C["a"]})}}]);