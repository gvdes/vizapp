(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[27],{"1add":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",[r("OrdersList",{attrs:{orders:e.orders},on:{clicked:e.orderclicked}}),r("q-dialog",{attrs:{position:"bottom",persistent:e.windCreate.blocked},model:{value:e.windCreate.state,callback:function(t){e.$set(e.windCreate,"state",t)},expression:"windCreate.state"}},[r("q-card",{staticClass:"bg-darkl0 exo text-grey-5"},[r("q-form",[r("q-toolbar",[e._v("Nuevo Pedido")]),r("q-card-section",[r("div",{staticClass:"row items-end q-gutter-sm"},[r("q-btn",{staticClass:"text-black",attrs:{icon:"fas fa-address-book",flat:"",dense:"",color:e.isclient?"green-13":"grey-8"},on:{click:function(t){e.isclient=!e.isclient}}}),r("q-input",{staticClass:"col",attrs:{dark:"",label:"Cliente",color:"green-13",autofocus:""},model:{value:e.windCreate.ipt.client,callback:function(t){e.$set(e.windCreate.ipt,"client",t)},expression:"windCreate.ipt.client"}}),e.cancreate?r("q-btn",{attrs:{flat:"",rounded:"",type:"submit",icon:"done",color:"green-13",disable:e.windCreate.ipt.load,loading:e.windCreate.ipt.load},on:{click:e.tryCreate}}):e._e()],1)])],1)],1)],1),r("q-page-sticky",{attrs:{position:"bottom-right",offset:[10,3]}},[r("q-btn",{attrs:{color:"teal",rounded:"",icon:"add"},on:{click:function(t){e.windCreate.state=!0}}})],1)],1)},a=[],i=r("bd4c"),s=r("5542"),n=r("6d5d"),d={name:"PreventaSales",components:{OrdersList:n["a"]},data(){return{orders_chart:{options:{chart:{id:"orders_chart",background:"none"},stroke:{colors:["#2D3035"]},theme:{palette:"palette8",mode:"dark"},labels:["En captura","Por surtir","Surtiendo","Cobrados","Completados"],colors:["#ced6e0","#fa8231","#1e90ff","#4cd137","#eb3b5a"]}},windCreate:{state:!1,ipt:{dis:!0,load:!1,client:""},blocked:!1},isclient:!1,socket:this.$sktPreventa}},async mounted(){this.$store.commit("Preventa/setHeaderTitle","Preventa | Pedidos"),this.socket.emit("join",{profile:this.profile,workpoint:this.workin.workpoint,room:this.sktroom}),this.socket.on("order_created",(e=>this.skt_order_created(e))),this.socket.on("order_changestate",(e=>this.skt_order_changestate(e)))},beforeDestroy(){this.socket.emit("unjoin",{profile:this.profile,workpoint:this.workin.workpoint,room:this.sktroom})},methods:{skt_order_created(e){let t=e.order,r=e.user.me;console.log(`%c${r.nick} esta creando la orden ${t.id}`,"background:#303952;color:#e66767;border-radius:10px;padding:8px;"),console.log(e),this.$store.commit("Preventa/newOrder",t)},skt_order_changestate(e){console.log(e);let t=e.order,r=e.newstate;console.log(`%cLa orden ${e.order.id} cambio su status a ${e.newstate.name}`,"background:#7158e2;color:#fffa65;border-radius:10px;padding:8px;"),this.$store.commit("Preventa/updateState",{order:t,newstate:r})},orderclicked(e){this.$router.push(`/preventa/pedidos/${e.id}`)},tryCreate(){this.windCreate.ipt.load=!0,this.windCreate.blocked=!0;let e=this.isclient?{id:this.windCreate.ipt.client}:{name:this.windCreate.ipt.client};s["a"].create(e).then((e=>{let t=e.data;console.log(t),this.windCreate.ipt.load=!1,this.windCreate.blocked=!1,this.$store.commit("Preventa/newOrder",t),this.socket.emit("order_created",{user:this.profile,order:t}),this.$router.push(`/preventa/pedidos/${t.id}`)})).catch((e=>{console.log(e),this.windCreate.ipt.load=!1,this.windCreate.blocked=!1,this.$q.notify({icon:"bug",message:e,color:"negative"})}))}},computed:{orders(){return this.$store.state.Preventa.orders},profile(){return this.$store.getters["Account/profile"]},workin(){return this.$store.getters["Account/workin"]},cancreate(){let e=this.isclient?1:3;return this.windCreate.ipt.client.length>=e},cardOrderDesign(){return e=>{switch(e.id){case 1:return"border-left:5px; border-color:green;!important";case 5:return"border-left:5px; border-color:blue; !important";default:return"border-left:5px; border-color:grey; !important"}}},series_chart(){return[this.orders_capture.length,this.orders_forsupply.length,this.orders_onsupply.length,this.orders_chargeds.length,this.orders_archive.length]},humantime(){return e=>{let t=Date.now(),r=Date.parse(e),o=i["b"].getDateDiff(t,r,"days");switch(o){case 0:return i["b"].formatDate(r,"hh:mm a");case 1:return"Ayer, "+i["b"].formatDate(r,"hh:mm a");default:return`Hace ${o} dias, `+i["b"].formatDate(r,"hh:mm a")}}},sktroom(){return this.profile.me._rol<=3?"admin":"orders"}}},c=d,l=r("2877"),h=r("9989"),p=r("24e8"),u=r("f09f"),m=r("0378"),k=r("65c6"),b=r("a370"),f=r("9c40"),g=r("27f9"),w=r("de5e"),C=r("eebe"),_=r.n(C),$=Object(l["a"])(c,o,a,!1,null,null,null);t["default"]=$.exports;_()($,"components",{QPage:h["a"],QDialog:p["a"],QCard:u["a"],QForm:m["a"],QToolbar:k["a"],QCardSection:b["a"],QBtn:f["a"],QInput:g["a"],QPageSticky:w["a"]})}}]);