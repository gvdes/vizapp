(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[30],{"1add":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("q-page",[t("div",{staticClass:"row q-pt-sm q-pb-xl"},[t("div",{staticClass:"col-md-6 col-xs-12 q-pa-sm"},[t("q-table",{attrs:{dark:"",flat:"",data:e.orders,columns:e.tableorders.columns,filter:e.tableorders.filtrator,pagination:e.tableorders.pagination,"card-class":"bg-darkl1",separator:"none","visible-columns":e.columns_view},scopedSlots:e._u([{key:"top",fn:function(){return[t("div",{staticClass:"full-width row items-center"},[t("div",{staticClass:"col"},[t("q-btn-toggle",{staticClass:"custom-toggle",attrs:{unelevated:"",rounded:"","toggle-color":"primary","no-caps":"",size:"sm",options:[{label:"",value:!0,icon:"fas fa-user"},{label:"",value:!1,icon:"fas fa-users"}]},model:{value:e.tableorders.view,callback:function(t){e.$set(e.tableorders,"view",t)},expression:"tableorders.view"}})],1),t("div",{staticClass:"col"},[t("q-input",{attrs:{borderless:"",dark:"",filled:"",dense:"","fill-input":"",color:"green-13",debounce:"0",placeholder:"Buscar..."},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.tableorders.filtrator,callback:function(t){e.$set(e.tableorders,"filtrator",t)},expression:"tableorders.filtrator"}})],1)])]},proxy:!0},{key:"no-data",fn:function(){return[t("div",{staticClass:"full-width row flex-center q-gutter-sm q-pa-md"},[t("q-icon",{attrs:{size:"2em",name:"sentiment_dissatisfied"}}),t("span",[e._v("Nada por aqui.")])],1)]},proxy:!0},{key:"body",fn:function(r){return[t("q-tr",{on:{click:function(t){return e.orderclicked(r.row)}}},[t("q-td",{key:"id"},[t("div",[t("span",{class:r.row._order?"ord_anx":""},[e._v(e._s(r.row.id))])]),t("div",{staticClass:"text--1 text-grey-5"},[e._v(e._s(e.filltkt(r.row.num_ticket)))])]),t("q-td",{key:"client",attrs:{align:"center"}},[e._v(e._s(r.row.name))]),t("q-td",{key:"cstate",class:`st-${r.row.status.id}`,attrs:{align:"center"}},[t("div",{staticClass:"text--1"},[e._v(e._s(r.row.status.name))]),t("div",{staticClass:"text--2 text-grey-5"},[e._v(e._s(e.humantime(r.row.updated_at)))])]),e.tableorders.view?e._e():t("q-td",{key:"createdby",attrs:{align:"center"}},[e._v("\n\t\t\t\t\t\t\t\t"+e._s(r.row.created_by.nick)+"\n\t\t\t\t\t\t\t")])],1)]}}])})],1)]),t("q-dialog",{attrs:{position:"bottom",persistent:e.windCreate.blocked},model:{value:e.windCreate.state,callback:function(t){e.$set(e.windCreate,"state",t)},expression:"windCreate.state"}},[t("q-card",{staticClass:"bg-darkl0 exo text-white"},[t("q-form",[t("q-toolbar",{staticClass:"bg-darkl2"},[e._v("Nuevo Pedido")]),t("q-card-section",[t("div",{staticClass:"row items-end q-gutter-sm"},[t("q-btn",{staticClass:"text-black",attrs:{icon:"fas fa-address-book",flat:"",dense:"",color:e.isclient?"green-13":"grey-8"},on:{click:function(t){e.isclient=!e.isclient}}}),t("q-input",{staticClass:"col",attrs:{dark:"",label:"Cliente",color:"green-13",autofocus:""},model:{value:e.windCreate.ipt.client,callback:function(t){e.$set(e.windCreate.ipt,"client",t)},expression:"windCreate.ipt.client"}}),e.cancreate?t("q-btn",{attrs:{flat:"",rounded:"",type:"submit",icon:"done",color:"green-13",disable:e.windCreate.ipt.load,loading:e.windCreate.ipt.load},on:{click:e.tryCreate}}):e._e()],1)])],1)],1)],1),t("q-page-sticky",{attrs:{position:"bottom-right",offset:[10,3]}},[t("q-btn",{attrs:{color:"primary",rounded:"",icon:"add"},on:{click:function(t){e.windCreate.state=!0}}})],1)],1)},s=[],i=(r("14d9"),r("bd4c")),o=r("5542"),n=r("6d5d"),l={name:"PreventaSales",components:{OrdersList:n["a"]},data(){return{psocket:this.$sktPreventa,orders_chart:{options:{chart:{id:"orders_chart",background:"none"},stroke:{colors:["#2D3035"]},theme:{palette:"palette8",mode:"dark"},labels:["En captura","Por surtir","Surtiendo","Cobrados","Completados"],colors:["#ced6e0","#fa8231","#1e90ff","#4cd137","#eb3b5a"]}},windCreate:{state:!1,ipt:{dis:!0,load:!1,client:""},blocked:!1},isclient:!1,tableorders:{view:!0,filtrator:"",columns:[{name:"id",field:"id",sortable:!0,label:"Folio",align:"center"},{name:"client",field:"name",sortable:!0,label:"Cliente",align:"center"},{name:"cstate",field:e=>e.status.id,sortable:!0,label:"Estado",align:"center"},{name:"createdby",field:e=>e.created_by.nick,sortable:!0,label:"Agente",align:"center"}],pagination:{sortBy:"id",descending:!0,rowsPerPage:10}}}},created(){this.$store.commit("Preventa/setHeaderTitle","Preventa | Pedidos")},methods:{orderclicked(e){let t=this.profile.me.id,r=(this.profile.me._rol,t==e.created_by.id),a=e.status.id;if(r)this.$router.push(`/preventa/pedidos/${e.id}`);else switch(a){case 1:this.$q.notify({message:`<b>${e.created_by.nick}</b> aun esta capturando este pedido.`,type:"warning",closeBtn:"Ok",timeout:3e3,position:"center",html:!0});break;default:this.$router.push(`/preventa/pedidos/${e.id}`);break}},tryCreate(){this.windCreate.ipt.load=!0,this.windCreate.blocked=!0;let e=this.isclient?{id:this.windCreate.ipt.client}:{name:this.windCreate.ipt.client};o["a"].create(e).then((e=>{let t=e.data;console.log(t),this.windCreate.ipt.load=!1,this.windCreate.blocked=!1,this.$store.commit("Preventa/newOrder",t),this.psocket.emit("order_add",{user:this.profile,order:t}),this.$router.push(`/preventa/pedidos/${t.id}`)})).catch((e=>{console.log(e),this.windCreate.ipt.load=!1,this.windCreate.blocked=!1,this.$q.notify({icon:"bug",message:e,color:"negative"})}))}},computed:{filltkt(){return e=>{let t=4,r=e.toString().length,a="";for(t;r<t;t--)a+="0";return`${a}${e}`}},allorders(){return this.$store.state.Preventa.orders},myorders(){return this.allorders.filter((e=>e.created_by.id==this.profile.me.id))},orders(){return this.tableorders.view?this.myorders:this.allorders},profile(){return this.$store.getters["Account/profile"]},workin(){return this.$store.getters["Account/workin"]},cancreate(){let e=this.isclient?1:3;return this.windCreate.ipt.client.length>=e},cardOrderDesign(){return e=>{switch(e.id){case 1:return"border-left:5px; border-color:green;!important";case 5:return"border-left:5px; border-color:blue; !important";default:return"border-left:5px; border-color:grey; !important"}}},series_chart(){return[this.orders_capture.length,this.orders_forsupply.length,this.orders_onsupply.length,this.orders_chargeds.length,this.orders_archive.length]},humantime(){return e=>{let t=Date.now(),r=Date.parse(e),a=i["b"].getDateDiff(t,r,"days");switch(a){case 0:return i["b"].formatDate(r,"hh:mm a");case 1:return"Ayer, "+i["b"].formatDate(r,"hh:mm a");default:return`Hace ${a} dias, `+i["b"].formatDate(r,"hh:mm a")}}},columns_view(){return this.tableorders.view?["id","client","cstate"]:["id","client","cstate","createdby"]}}},d=l,c=r("2877"),u=r("9989"),p=r("eaac"),b=r("6a67"),f=r("27f9"),m=r("0016"),h=r("bd08"),g=r("db86"),w=r("24e8"),k=r("f09f"),v=r("0378"),C=r("65c6"),_=r("a370"),y=r("9c40"),q=r("de5e"),x=r("eebe"),$=r.n(x),Q=Object(c["a"])(d,a,s,!1,null,null,null);t["default"]=Q.exports;$()(Q,"components",{QPage:u["a"],QTable:p["a"],QBtnToggle:b["a"],QInput:f["a"],QIcon:m["a"],QTr:h["a"],QTd:g["a"],QDialog:w["a"],QCard:k["a"],QForm:v["a"],QToolbar:C["a"],QCardSection:_["a"],QBtn:y["a"],QPageSticky:q["a"]})}}]);