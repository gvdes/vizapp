(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[24],{"0694":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",[a("q-header",{staticClass:"bg-darkl0 text-grey-5"},[a("q-card",{staticClass:"bg-darkl1"},[a("toolbar-account",{attrs:{title:"Preventa"}}),a("div",{staticClass:"q-pa-md row"},[a("div",{staticClass:"col-md col-xs-12"},[a("RangeDates",{on:{inputRanges:t.loadView}})],1)])],1)],1),a("div",{staticClass:"row items-start"},[a("div",{staticClass:"col-md col-xs-12"},[a("q-card",{staticClass:"bg-darkl1"},[a("q-card-section",[t._v("Resumen")]),a("q-card-section")],1)],1),a("div",{staticClass:"col-md col-xs-12"},[a("q-card",{staticClass:"bg-darkl1"},[a("q-card-section",[a("q-table",{attrs:{data:t.orders_db,flat:"","row-key":"id",dark:"",filter:t.tableorders.filtrator,"card-class":"q-pa-sm bg-none text-grey-6",columns:t.tableorders.columns},scopedSlots:t._u([t.orders_db.length?{key:"top-right",fn:function(){return[a("q-input",{attrs:{color:"green-13",dark:"",dense:"",debounce:"0",placeholder:"Buscar (folio o nombre)"},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}})]},proxy:!0}],null,!1,4009527860),model:{value:t.tableorders.filtrator,callback:function(e){t.$set(t.tableorders,"filtrator",e)},expression:"tableorders.filtrator"}})]},proxy:!0}:null,{key:"body",fn:function(e){return[a("q-tr",{attrs:{props:e},on:{click:function(a){return t.open(e.row.id)}}},[a("q-td",{key:"id",attrs:{props:e}},[t._v(t._s(e.row.id))]),a("q-td",{key:"client",attrs:{props:e}},[t._v(t._s(e.row.name))]),a("q-td",{key:"timestart",attrs:{props:e}},[t._v(t._s(t.humantime(e.row.created_at)))])],1)]}}],null,!0)})],1)],1)],1)]),a("q-dialog",{attrs:{position:"bottom",persistent:t.windCreate.blocked},model:{value:t.windCreate.state,callback:function(e){t.$set(t.windCreate,"state",e)},expression:"windCreate.state"}},[a("q-card",{staticClass:"bg-darkl0 exo text-grey-5"},[a("q-form",[a("q-toolbar",[t._v("Nuevo Pedido")]),a("q-card-section",[a("div",{staticClass:"row items-end q-gutter-sm"},[a("q-btn",{staticClass:"text-black",attrs:{icon:"fas fa-address-book",flat:"",dense:"",color:t.isclient?"green-13":"grey-8"},on:{click:function(e){t.isclient=!t.isclient}}}),a("q-input",{staticClass:"col",attrs:{dark:"",label:"Cliente",color:"green-13",autofocus:""},model:{value:t.windCreate.ipt.client,callback:function(e){t.$set(t.windCreate.ipt,"client",e)},expression:"windCreate.ipt.client"}}),t.cancreate?a("q-btn",{attrs:{flat:"",rounded:"",type:"submit",icon:"done",color:"green-13",disable:t.windCreate.ipt.load,loading:t.windCreate.ipt.load},on:{click:t.tryCreate}}):t._e()],1)])],1)],1)],1),a("q-page-sticky",{attrs:{position:"bottom-right",offset:[10,3]}},[a("q-btn",{staticClass:"bg-darkl1 shadow-1",attrs:{rounded:"",flat:"",color:"green-13",icon:"add"},on:{click:function(e){t.windCreate.state=!0}}})],1)],1)},r=[],i=a("1321"),o=a.n(i),l=a("bd4c"),n=a("1d6c"),d=a("5542"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md col-xs-12 row items-end",class:t.$q.screen.lt.md?"justify-between":"justify-end"},[a("q-select",{attrs:{dark:"",color:"green-13",label:"Vista",options:t.selectViews.opts},on:{input:t.setDates},model:{value:t.selectViews.selected,callback:function(e){t.$set(t.selectViews,"selected",e)},expression:"selectViews.selected"}}),a("div",{staticClass:"q-pl-md"},["c"==t.selectViews.selected.value?[a("q-btn",{attrs:{rounded:"",color:"primary",icon:"fas fa-calendar-day","no-caps":""}},[a("q-popup-proxy",[a("q-card",{staticClass:"bg-darkl1 text-grey-5 exo"},[a("q-card-section",[t._v("Seleccione periodo")]),a("q-tabs",{staticClass:"bg-dark text-white shadow-2",attrs:{align:"justify",breakpoint:0},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("q-tab",{attrs:{name:"f",label:this.ranges.date.from+" "+this.ranges.time.from,"no-caps":""}}),a("q-tab",{attrs:{name:"t",label:this.ranges.date.to+" "+this.ranges.time.to,"no-caps":""}})],1),a("q-tab-panels",{staticClass:"text-center bg-darkl1",attrs:{animated:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"f"}},[a("q-date",{attrs:{minimal:"",flat:"",dark:""},model:{value:this.ranges.date.from,callback:function(e){t.$set(this.ranges.date,"from",e)},expression:"this.ranges.date.from"}}),a("div",{staticClass:"text-left q-pt-md"},[a("div",{staticClass:"row items-center"},[a("span",{staticClass:"col-3"},[t._v("Hora:")]),a("q-slider",{staticClass:"col",attrs:{label:"",min:8,max:23},model:{value:t.times.from.h,callback:function(e){t.$set(t.times.from,"h",e)},expression:"times.from.h"}}),a("span",{staticClass:"col-2 text-right"},[t._v(t._s(t.times.from.h))])],1),a("div",{staticClass:"row items-center"},[a("span",{staticClass:"col-3"},[t._v("Minuto:")]),a("q-slider",{staticClass:"col",attrs:{label:"",min:0,max:59,step:10},model:{value:t.times.from.m,callback:function(e){t.$set(t.times.from,"m",e)},expression:"times.from.m"}}),a("span",{staticClass:"col-2 text-right"},[t._v(t._s(t.times.from.m))])],1)])],1),a("q-tab-panel",{attrs:{name:"t"}},[a("q-date",{attrs:{minimal:"",flat:"",dark:""},model:{value:this.ranges.date.to,callback:function(e){t.$set(this.ranges.date,"to",e)},expression:"this.ranges.date.to"}}),a("div",{staticClass:"text-left q-pt-md"},[a("div",{staticClass:"row items-center"},[a("span",{staticClass:"col-3"},[t._v("Hora:")]),a("q-slider",{staticClass:"col",attrs:{label:"",min:9,max:23},model:{value:t.times.to.h,callback:function(e){t.$set(t.times.to,"h",e)},expression:"times.to.h"}}),a("span",{staticClass:"col-2 text-right"},[t._v(t._s(t.times.to.h))])],1),a("div",{staticClass:"row items-center"},[a("span",{staticClass:"col-3"},[t._v("Minuto:")]),a("q-slider",{staticClass:"col",attrs:{label:"",min:0,max:59,step:10},model:{value:t.times.to.m,callback:function(e){t.$set(t.times.to,"m",e)},expression:"times.to.m"}}),a("span",{staticClass:"col-2 text-right"},[t._v(t._s(t.times.to.m))])],1)])],1)],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"OK"}})],1)],1)],1)],1)]:[a("div",{staticClass:"row q-gutter-md"},[a("div",{staticClass:"text-right"},[a("div",{staticClass:"text--1 text-grey-3"},[t._v(t._s(this.ranges.date.display.from))]),a("div",{staticClass:"text--2"},[t._v(t._s(this.ranges.time.display.from))])]),a("div",{staticClass:"text-right"},[a("div",{staticClass:"text--1 text-grey-3"},[t._v(t._s(this.ranges.date.display.to))]),a("div",{staticClass:"text--2"},[t._v(t._s(this.ranges.time.display.to))])])])]],2)],1)},m=[],f={name:"RangeDates",props:{label:{type:String,default:"Vista"},useTime:{type:Boolean,default:!1}},data(){return{selectViews:{opts:[{label:"Diaria",value:"t"},{label:"Semanal",value:"w"},{label:"Mensual",value:"m"},{label:"Anual",value:"y"},{label:"Personalizada",value:"c",disable:!0}],selected:{label:"Diaria",value:"t"}},ranges:{date:{from:null,to:null,display:{from:null,to:null}},time:{from:null,to:null,display:{from:null,to:null}}},tab:"f",times:{from:{h:9,m:0},to:{h:9,m:0}}}},beforeMount(){this.setDates()},methods:{setDates(){let t=this.selectViews.selected,e=this.$moment(),a=!0;switch(t.value){case"w":this.ranges.date.from=e.startOf("week").format("YYYY-MM-DD"),this.ranges.date.display.from=e.startOf("week").format("YYYY/MM/DD");break;case"m":this.ranges.date.from=e.startOf("month").format("YYYY-MM-DD"),this.ranges.date.display.from=e.startOf("month").format("YYYY/MM/DD");break;case"y":this.ranges.date.from=e.startOf("year").format("YYYY-MM-DD"),this.ranges.date.display.from=e.startOf("year").format("YYYY/MM/DD");break;case"c":console.log("Esperando rango de fechas..."),a=!1;break;default:this.ranges.date.from=this.$moment().format("YYYY-MM-DD"),this.ranges.date.to=this.$moment().format("YYYY-MM-DD"),this.ranges.time.from=this.$moment().startOf("day").add(8,"h").format("HH:mm:ss"),this.ranges.time.to=this.$moment().endOf("day").format("HH:mm:ss"),this.ranges.date.display.from=this.$moment().format("YYYY/MM/DD"),this.ranges.date.display.to=this.$moment().format("YYYY/MM/DD"),this.ranges.time.display.from=this.$moment().startOf("day").add(8,"h").format("hh:mm a"),this.ranges.time.display.to=this.$moment().endOf("day").format("hh:mm a");break}a&&this.$emit("inputRanges",{ranges:this.ranges,option:this.selectViews.selected,dbranges:this.dbranges})}},computed:{dbranges(){return{from:`${this.ranges.date.from} ${this.ranges.time.from}`,to:`${this.ranges.date.to} ${this.ranges.time.to}`}}}},h=f,u=a("2877"),p=a("ddd8"),b=a("9c40"),g=a("7cbe"),v=a("f09f"),C=a("a370"),w=a("429b"),k=a("7460"),y=a("adad"),_=a("823b"),x=a("52ee"),q=a("c1d0"),Y=a("4b7e"),D=a("7f67"),$=a("eebe"),Q=a.n($),M=Object(u["a"])(h,c,m,!1,null,null,null),O=M.exports;Q()(M,"components",{QSelect:p["a"],QBtn:b["a"],QPopupProxy:g["a"],QCard:v["a"],QCardSection:C["a"],QTabs:w["a"],QTab:k["a"],QTabPanels:y["a"],QTabPanel:_["a"],QDate:x["a"],QSlider:q["a"],QCardActions:Y["a"]}),Q()(M,"directives",{ClosePopup:D["a"]});var P={components:{apexchart:o.a,ToolbarAccount:n["a"],RangeDates:O},data(){return{orders_chart:{options:{chart:{id:"orders_chart",background:"none"},stroke:{colors:["#2D3035"]},theme:{palette:"palette8",mode:"dark"},labels:["En captura","Por surtir","Surtiendo","Cobrados","Completados"],colors:["#ced6e0","#fa8231","#1e90ff","#4cd137","#eb3b5a"]}},windCreate:{state:!1,ipt:{dis:!0,load:!1,client:""},blocked:!1},index:void 0,tableorders:{columns:[{name:"id",align:"left",label:"Folio",field:"id"},{name:"client",align:"left",label:"Cliente",field:"name",sortable:!0},{name:"timestart",align:"center",label:"Hora",field:"created_at",sortable:!0},{name:"cstate",align:"center",label:"Estado",field:"created_at",sortable:!0}],filtrator:""},isclient:!1}},async beforeMount(){},beforeDestroy(){console.log("desconectando del room"),this.$sktPreventa.off()},methods:{async loadView(t){this.index=void 0,this.$q.loading.show({message:"Cargando vista..."});let e={date_from:t.dbranges.from,date_to:t.dbranges.to};console.log("%cCargando vista...","font-size:1.5em;color:red;"),console.log(e),this.index=await d["a"].index(e),console.log(this.index),this.$q.loading.hide()},tryCreate(){this.windCreate.ipt.load=!0,this.windCreate.blocked=!0;let t=this.isclient?{id:this.windCreate.ipt.client}:{name:this.windCreate.ipt.client};console.log(t),d["a"].create(t).then((t=>{let e=t.data;console.log(e),this.windCreate.ipt.load=!1,this.windCreate.blocked=!1,this.$router.push(`/preventa/${e.id}`)})).catch((t=>{console.log(t),this.windCreate.ipt.load=!1,this.windCreate.blocked=!1,this.$q.notify({icon:"bug",message:t,color:"negative"})}))},open(t){this.$router.push(`/preventa/${t}`)},sktjoinprev(t){console.log(t)},sktjoinprevwrh(t){console.log(t)}},computed:{profile(){return this.$store.getters["Account/profile"]},workin(){return this.$store.getters["Account/workin"]},cancreate(){let t=this.isclient?1:3;return this.windCreate.ipt.client.length>=t},orders_db(){return this.index?this.index.orders:[]},orders_capture(){return this.orders_db.filter((t=>1==t.status.id))},orders_forsupply(){return this.orders_db.filter((t=>2==t.status.id))},orders_onsupply(){return this.orders_db.filter((t=>3==t.status.id))},orders_chargeds(){return this.orders_db.filter((t=>4==t.status.id))},orders_archive(){return this.orders_db.filter((t=>5==t.status.id))},series_chart(){return[this.orders_capture.length,this.orders_forsupply.length,this.orders_onsupply.length,this.orders_chargeds.length,this.orders_archive.length]},humantime(){return t=>{let e=Date.now(),a=Date.parse(t),s=l["b"].getDateDiff(e,a,"days");switch(s){case 0:return l["b"].formatDate(a,"hh:mm a");case 1:return"Ayer, "+l["b"].formatDate(a,"hh:mm a");default:return`Hace ${s} dias, `+l["b"].formatDate(a,"hh:mm a")}}}}},V=P,S=a("9989"),T=a("e359"),H=a("eaac"),j=a("27f9"),A=a("0016"),R=a("bd08"),E=a("db86"),B=a("24e8"),z=a("0378"),F=a("65c6"),I=a("de5e"),J=Object(u["a"])(V,s,r,!1,null,null,null);e["default"]=J.exports;Q()(J,"components",{QPage:S["a"],QHeader:T["a"],QCard:v["a"],QCardSection:C["a"],QTable:H["a"],QInput:j["a"],QIcon:A["a"],QTr:R["a"],QTd:E["a"],QDialog:B["a"],QForm:z["a"],QToolbar:F["a"],QBtn:b["a"],QPageSticky:I["a"]})}}]);