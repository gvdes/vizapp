(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{"0cf5":function(t,e,n){},"1b91":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",{attrs:{padding:""}},[n("q-header",{staticClass:"bg-darkl0 text-grey-5 q-pa-sm"},[n("q-card",{staticClass:"bg-darkl1"},[n("toolbar-account",{attrs:{title:"Inventarios"}})],1)],1),n("router-view"),n("div",[t.inventories.length?[n("div",{staticClass:"row q-pl-sm"},t._l(t.inventories,(function(e){return n("q-card",{key:e.id,staticClass:"col-xs-12 col-md-3 q-mb-sm q-mr-sm bg-darkl1"},[n("q-card-section",{staticClass:"row justify-between items-start"},[n("div",[n("div",{staticClass:"text-h5 text-green-13"},[t._v(t._s(e.id))]),n("div",[t._v("[ "+t._s(e.type.name)+" ]")])]),n("div",{staticClass:"text--1 text-right"},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(e.created_at)),n("br"),t._v("\n\t\t\t\t\t\t\t\t"+t._s(e.created_by.names)+" [ "+t._s(e.created_by.nick)+" ]\n\t\t\t\t\t\t\t")])]),n("q-separator"),n("q-card-section",[n("div",{staticClass:"row items-end"},[n("div",{staticClass:"col"},[t._v("\n\t\t\t\t\t\t\t\t\tResponsables ["+t._s(e.responsables.length)+"]:\n\t\t\t\t\t\t\t\t\t"),n("br")]),1==e.status.id?[t.imAdmin(e.created_by)?n("q-btn",{attrs:{rounded:"",flat:"",color:"light-blue-13",icon:"settings"},on:{click:function(n){return t.$router.push("contador/config/"+e.id)}}}):n("q-spinner-dots",{attrs:{color:"amber-13",size:"md"}})]:t._e(),2==e.status.id?[t.imAdmin(e.created_by)?n("q-btn",{attrs:{rounded:"",flat:"",color:"light-blue-13",icon:"settings"},on:{click:function(n){return t.$router.push("contador/config/"+e.id)}}}):t._e(),n("q-btn",{attrs:{rounded:"",flat:"",color:"green-13",icon:"launch"},on:{click:function(n){return t.$router.push("contador/"+e.id)}}})]:t._e()],2)])],1)})),1)]:t._e()],2),n("q-dialog",{attrs:{position:"bottom"},model:{value:t.wndCreate.state,callback:function(e){t.$set(t.wndCreate,"state",e)},expression:"wndCreate.state"}},[n("q-card",{staticClass:"bg-darkl0 text-grey-5 exo"},[n("q-form",[n("q-card-section",[t._v("Nuevo Inventario")]),n("q-separator"),n("q-card-section",[n("q-select",{attrs:{dark:"",flat:"",color:"green-13","option-value":"id","option-label":"name",options:t.types,rules:[function(t){return t||"Seleccione tipo de Inventario"}],label:"Tipo:"},model:{value:t.wndCreate.form.type,callback:function(e){t.$set(t.wndCreate.form,"type",e)},expression:"wndCreate.form.type"}}),n("q-input",{attrs:{dark:"",flat:"",color:"green-13",label:"Notas:"},model:{value:t.wndCreate.form.notes,callback:function(e){t.$set(t.wndCreate.form,"notes",e)},expression:"wndCreate.form.notes"}})],1),n("q-card-actions",{attrs:{align:"right"}},[n("q-btn",{attrs:{color:"green-13",dark:"",flat:"",label:"Crear",type:"submit",disabled:t.wndCreate.loading,loading:t.wndCreate.loading},on:{click:t.create}})],1)],1)],1)],1),n("q-page-sticky",{attrs:{position:"bottom-right",offset:[10,10]}},[n("q-btn",{staticClass:"text-green-13 bg-darkl1 shadow-1",attrs:{flat:"",rounded:"",icon:"add"},on:{click:function(e){t.wndCreate.state=!0}}})],1)],1)},o=[],r=(n("e6cf"),n("8e27")),i=n.n(r),s=n("e0df"),c=n("1d6c"),d={components:{ToolbarAccount:c["a"]},data(){return{index:null,wndCreate:{state:!1,form:{type:null,notes:null},creating:!1},counterType:{label:"Categoria",value:1},sktcounter:null}},async beforeMount(){this.$q.loading.show(),this.index=await s["a"].index(),console.log(this.index),this.$q.loading.hide(),console.log("MONTANDO SOCKET"),this.sktcounter=await i()(`${this.$vsocket}/counters`),this.sktcounter.emit("index",this.profile),this.sktcounter.on("connected",(t=>{console.log(t)}))},methods:{create(){if(console.log("Creando Nuevo Conteo"),this.wndCreate.form.type){this.wndCreate.creating=!0;let t={_type:this.wndCreate.form.type.id,notes:this.wndCreate.form.notes,token:this.$vizapi.defaults.headers.common["Authorization"]};s["a"].create(t).then((t=>{let e=t.data.inventory;e.products=[],this.wndCreate.creating=!1,this.index.inventory.unshift(e),this.wndCreate.creating=!1,this.wndCreate.state=!1,this.$q.notify({icon:"done",color:"positive",position:"center",message:`Inventario ${e.id} creado...`}),this.$router.push("/almacen/contador/config/"+e.id)})).catch((t=>{console.log(t)}))}},drop(t){console.log("Eliminar Inventario?"),console.log(t)}},computed:{states(){return this.index?this.index.status:[]},types(){return this.index?this.index.type:[]},inventories(){return this.index?this.index.inventory.filter((t=>4!=t.status.id)):[]},labelStep(){return t=>{let e="";switch(t){case 1:e="Iniciar";break;case 2:e="Finalizar";break}return e}},profile(){return this.$store.getters["Account/profile"]},imAdmin(){return t=>t.id==this.profile.me.id}}},l=d,u=(n("1d9e"),n("2877")),p=n("9989"),f=n("e359"),h=n("f09f"),g=n("a370"),m=n("eb85"),b=n("9c40"),C=n("8380"),v=n("24e8"),w=n("0378"),k=n("ddd8"),q=n("27f9"),y=n("4b7e"),x=n("de5e"),_=n("eaac"),$=n("eebe"),Q=n.n($),A=Object(u["a"])(l,a,o,!1,null,null,null);e["default"]=A.exports;Q()(A,"components",{QPage:p["a"],QHeader:f["a"],QCard:h["a"],QCardSection:g["a"],QSeparator:m["a"],QBtn:b["a"],QSpinnerDots:C["a"],QDialog:v["a"],QForm:w["a"],QSelect:k["a"],QInput:q["a"],QCardActions:y["a"],QPageSticky:x["a"],QTable:_["a"]})},"1d9e":function(t,e,n){"use strict";n("0cf5")}}]);