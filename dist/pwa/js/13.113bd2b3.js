(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{"689e":function(t,e,s){"use strict";s("7a34")},"7a34":function(t,e,s){},fa13:function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{staticClass:"column items-center justify-center",attrs:{padding:""}},[s("div",[t._v("Socket: "+t._s(t.socket.connected))]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.iptsearch.model,expression:"iptsearch.model"}],ref:"ipt_search",attrs:{type:"text",autocomplete:"off",id:"ipt_search"},domProps:{value:t.iptsearch.model},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search.apply(null,arguments)},focus:function(e){return t.listenipt(!0)},blur:function(e){return t.listenipt(!1)},input:function(e){e.target.composing||t.$set(t.iptsearch,"model",e.target.value)}}}),"listen"==t.gstate?s("div",{staticClass:"q-mt-xl"},[s("div",{staticClass:"q-pa-md"},[t._v("Pedidos por llegar: "+t._s(t.orders.length))]),s("div",{staticClass:"row items-center q-gutter-sm"},t._l(t.orders,(function(e){return s("q-card",{key:e.id,staticClass:"bg-darkl1"},[s("q-card-section",[t._v("\n\t\t\t\t\t"+t._s(e.name)+" ("+t._s(e.id)+")\n\t\t\t\t")])],1)})),1)]):t._e(),"frontfounded"==t.gstate?s("div",[s("div",{staticClass:"text-center"},[s("div",{staticClass:"text-h1"},[s("q-spinner-hourglass",{attrs:{color:"light-blue-14",size:"2em"}})],1),s("div",{staticClass:"text-h4 q-mt-md"},[t._v("Hola "),s("span",{staticClass:"text-light-blue-14 text-bold"},[t._v(t._s(t.target.name))]),t._v(" ...")])])]):t._e(),"changesuccess"==t.gstate?s("div",[s("div",{staticClass:"text-center"},[s("div",{staticClass:"text-h5 q-mb-md"},[s("span",{staticClass:"text-green-13 text-uppercase text-bold"},[t._v(t._s(t.target.name)+",")]),t._v(" ya estamos surtiendo tu pedido. Te llamaremos pronto!!")]),s("div",{staticClass:"text-h1"},[s("q-icon",{attrs:{name:"far fa-grin-wink",color:"green-13",size:"3em"}})],1)])]):t._e(),"frontnotfound"==t.gstate?s("div",[s("div",{staticClass:"text-center"},[s("div",{staticClass:"text-h5 text-amber-13"},[t._v("Vaya!!, no hay coincidencias para tu codigo.")]),s("div",{staticClass:"text-h1"},[s("q-img",{attrs:{src:"https://stickerly.pstatic.net/sticker_pack/13279e882d3a25af/9CZFJ4/2/3a788547-d7ef-4aa9-a93f-2f23ee9655c0-003.png",width:"300px"}})],1)])]):t._e()])},a=[],i=s("6d5d"),o=s("5542"),n={components:{OrdersList:i["a"]},data(){return{socket:this.$sktPreventa,iptsearch:{model:"",focus:!1},gstate:"listen",searching:!1,target:void 0}},beforeMount(){this.$store.commit("Preventa/setHeaderTitle","Preventa | CheckIn"),this.socket.emit("join",{profile:this.profile,workpoint:this.workin.workpoint,room:"checkin"}),this.socket.on("order_changestate",(t=>this.skt_add_update_order(t))),this.$store.commit("Preventa/setHeaderState",!1)},mounted(){this.$refs.ipt_search.focus()},methods:{listenipt(t){this.iptsearch.focus=t},search(){this.gstate="searching";let t=this.orders.findIndex((t=>this.iptsearch.model==t.id));-1==t?(this.gstate="frontnotfound",this.iptsearch.model="",setTimeout((()=>{this.gstate="listen",this.$refs.ipt_search.focus()}),3e3)):(this.target=this.orders[t],this.gstate="frontfounded",this.nextStep())},async nextStep(){let t=await o["a"].nextStep({_order:this.target.id});if(t.success){let e=Object.assign({},this.target),s=t.status[t.status.length-1];this.socket.emit("order_changestate",{order:e,newstate:s}),this.iptsearch.model="",this.$store.commit("Preventa/updateState",{order:e,newstate:s}),setTimeout((()=>{this.gstate="changesuccess",setTimeout((()=>{this.gstate="listen",this.$refs.ipt_search.focus(),this.target=void 0}),4e3)}),2500)}},skt_add_update_order(t){console.log("%cUna orden ha cambiado el","background:#7158e2;color:#fffa65;border-radius:10px;padding:8px;");let e=t.order,s=t.newstate,r=this.orders.findIndex((t=>t.id==e.id));r>=0?(console.log(`%cActualizar la orden ${e.id}...`,"background:#7158e2;color:#fffa65;border-radius:10px;padding:8px;"),this.appsounds.created.play(),this.$store.commit("Preventa/updateState",{order:e,newstate:s})):(console.log(`%cAgregar la orden ${e.id}...`,"background:#7158e2;color:#fffa65;border-radius:10px;padding:8px;"),this.appsounds.created.play(),this.$store.commit("Preventa/newOrder",e))},orderclicked(t){console.log(t)}},beforeDestroy(){this.socket.emit("unjoin",{profile:this.profile,workpoint:this.workin.workpoint,room:"checkin"})},destroyed(){this.$store.commit("Preventa/setHeaderState",!0)},computed:{orders(){return this.$store.getters["Preventa/OrdersCheckIn"]},profile(){return this.$store.getters["Account/profile"]},workin(){return this.$store.getters["Account/workin"]},appsounds(){return this.$store.getters["Multimediapp/sounds"]}}},c=n,d=(s("689e"),s("2877")),l=s("9989"),p=s("a154"),h=s("0016"),u=s("f09f"),m=s("a370"),f=s("9149"),g=s("068f"),v=s("eebe"),k=s.n(v),_=Object(d["a"])(c,r,a,!1,null,"64c1bfa4",null);e["default"]=_.exports;k()(_,"components",{QPage:l["a"],QSpinnerBars:p["a"],QIcon:h["a"],QCard:u["a"],QCardSection:m["a"],QSpinnerHourglass:f["a"],QImg:g["a"]})}}]);