(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{"5ed6":function(t,e,o){"use strict";var s=o("31b8");e["a"]={index(){return s["b"].get("/location/index").then((t=>t.data)).catch((t=>{console.log(t)}))},tree(t){return s["b"].get("/location/allSections",t)},warehouses(t){return s["b"].get("/location/cellers")},list(){return s["b"].get("/location/cellers").then((t=>t.data.cellers)).catch((t=>{console.log(t)}))},loadWarehouses(){return console.log("%cCargando Almacenes...","font-size:2em; color:purple;"),s["b"].get("/location/cellers").then((t=>t.data.cellers)).catch((t=>{console.log(t)}))},sections(t){return s["b"].get("/location/sections",t).then((t=>t.data.sections)).catch((t=>{console.log(t)}))},product(t){return console.log(t),s["b"].get("/location/product",t)},toggle(t){return s["b"].post("/location/toggle",t)},create(t){return s["b"].post("/location/celler",t)},addSections(t){return s["b"].post("/location/section",t)},setminmax(t){return console.log(t),s["b"].post("/location/maximos",t)},existencesIndex(t){return s["b"].post("/product/catalog",t).then((t=>t.data)).catch((t=>{console.log("===========ERROR==========="),console.log(t)}))},loadCats(t){return s["b"].post("/product/catalog",t)},getStocks(t){return s["b"].post("/location/stocks",t)},getFiltred(t){return s["b"].post("/product/catalog",t)},report(t){return s["b"].post("/location/report",t)},sectionRemove(t){return s["b"].post("/location/remove",t)},sectionDelete(t){return s["b"].post("/location/deleteSection",t)}}},a647:function(t,e,o){"use strict";var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"row items-end"},[o("q-select",{staticClass:"col-3 q-mr-sm q-mb-sm",attrs:{dark:"",color:"green-13",label:"Almacen","option-value":"id","option-label":"name",options:t.warehouses.options},on:{input:t.setWarehouse},model:{value:t.warehouses.selected,callback:function(e){t.$set(t.warehouses,"selected",e)},expression:"warehouses.selected"}}),t._l(t.warehouses.sections,(function(e,s){return o("q-select",{key:s,staticClass:"col-2 q-mr-sm q-mb-sm",attrs:{dark:"",color:"amber-13",label:"Seleccione",options:t.warehouses.sections[s].options,"option-value":"id","option-label":"alias"},on:{input:function(e){return t.loadSections(t.warehouses.sections[s],s)}},model:{value:t.warehouses.sections[s].model.value,callback:function(e){t.$set(t.warehouses.sections[s].model,"value",e)},expression:"warehouses.sections[idx].model.value"}})})),o("q-inner-loading",{attrs:{showing:t.loading.state,dark:""}},[o("q-spinner-dots",{attrs:{size:"30px",color:"amber-7"}})],1)],2)},a=[],n=(o("a434"),o("e6cf"),o("5ed6")),i=o("f7cb"),l={props:{fetchproducts:{type:Boolean,default:!0}},data(){return{warehouses:{selected:null,options:[],sections:[]},filters:{paginate:null,_category:null,_location:null,check_stock:!1,with_stock:!1,_status:null,check_locations:!0},loading:{state:!1,msg:""}}},async beforeMount(){console.log("%cMontando componente","font-size:2em; color:gold;"),this.loading.state=!0;let t=JSON.parse(localStorage.getItem("statelocator"));t?this.warehouses=t:this.warehouses.options=await n["a"].list(),this.loading.state=!1},methods:{async setWarehouse(){this.loading.state=!0,this.warehouses.sections=[];let t={params:{_celler:this.warehouses.selected.id,products:!1}},e=await n["a"].sections(t);if(e.length){let t={options:e,model:{label:"Seleccione",value:null}};this.warehouses.sections.push(t)}this.loading.state=!1,this.selectedLoc()},async loadSections(t,e){this.loading.state=!0,this.warehouses.sections.splice(e+1);let o={params:{_section:t.model.value.id,products:!1}},s=await n["a"].sections(o);if(s.sections.length){let t={options:s.sections,model:{label:"Seleccione",value:null}};this.warehouses.sections.push(t)}this.selectedLoc(t)},async selectedLoc(t=null){this.filters._location=t?t.model.value.id:null;let e={warehouse:this.warehouses.selected,section:t,products:[],path:this.fullpath};this.fetchproducts&&t&&(console.log("cargando productos!!"),e.products=await i["a"].get(this.filters)),this.loading.state=!1,localStorage.setItem("statelocator",JSON.stringify(this.warehouses)),this.$emit("selectedLoc",e)}},computed:{fullpath(){return this.warehouses.sections.map((t=>{if(t.model.value)return t.model}))}}},c=l,r=o("2877"),d=o("ddd8"),u=o("74f7"),p=o("8380"),h=o("eebe"),g=o.n(h),m=Object(r["a"])(c,s,a,!1,null,null,null);e["a"]=m.exports;g()(m,"components",{QSelect:d["a"],QInnerLoading:u["a"],QSpinnerDots:p["a"]})},b293:function(t,e,o){"use strict";var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("q-select",{staticClass:"text-uppercase",attrs:{dark:"",dense:"",filled:"","fill-input":"",color:"green-13","use-input":"","hide-dropdown-icon":"","input-debounce":"0","option-value":"id","option-label":"code","hide-selected":"",behavior:"menu",autofocus:"",value:t.autocom.model,options:t.autocom.options,type:t.iptsearch.type},on:{filter:t.autocomplete,input:t.selItem},scopedSlots:t._u([{key:"no-option",fn:function(){return[o("q-item",[o("q-item-section",{staticClass:"text-grey"},[t._v("Sin coincidencias")])],1)]},proxy:!0},{key:"prepend",fn:function(){return[o("q-btn",{attrs:{type:"button",dense:"",size:"sm",flat:"",icon:t.iptsearch.icon,color:"grey-6"},on:{click:t.toogleIptSearch}})]},proxy:!0},{key:"option",fn:function(e){return[e.opt.status.id>1?o("div",t._b({staticClass:"text-grey-7 q-pa-sm"},"div",e.itemProps,!1),[o("div",{staticClass:"text-bold"},[t._v("\n                    "+t._s(e.opt.code)+" - "+t._s(e.opt.name)+"\n                    "),o("q-chip",{staticClass:"text--2",attrs:{color:"red","text-color":"white",icon:"warning",label:e.opt.status.name}})],1),o("div",{staticClass:"text--2",attrs:{caption:""}},[t._v(t._s(e.opt.description))])]):o("div",t._g(t._b({staticClass:"q-pa-sm q-mb-sm"},"div",e.itemProps,!1),e.itemEvents),[o("div",{staticClass:"text-body1 text-bold"},[t._v("\n                    "+t._s(e.opt.code)+" - "+t._s(e.opt.name)+"\n                ")]),o("div",{staticClass:"text--2",attrs:{caption:""}},[t._v(t._s(e.opt.description))])])]}}]),model:{value:t.autocom.model,callback:function(e){t.$set(t.autocom,"model",e)},expression:"autocom.model"}})],1)},a=[],n=(o("498a"),o("f7cb")),i={props:{checkState:{default:!1,type:Boolean},image:{default:!1,type:Boolean}},data(){return{autocom:{model:null,options:void 0},iptsearch:{processing:!1,type:"text",icon:"fas fa-hashtag"}}},methods:{autocomplete(t,e,o){let s={params:{code:t.trim()}};n["a"].autocomplete(s).then((t=>{let o=t.data;e((()=>{this.autocom.options=o}))})).catch((t=>{console.log(t)}))},toogleIptSearch(){switch(this.iptsearch.type){case"text":this.iptsearch.type="number",this.iptsearch.icon="fas fa-font";break;case"number":this.iptsearch.type="text",this.iptsearch.icon="fas fa-hashtag";break}this.$refs.iptsearch.focus()},selItem(t){this.$emit("input",t),setTimeout((()=>{this.autocom.model=null}),100)}}},l=i,c=o("2877"),r=o("ddd8"),d=o("66e5"),u=o("4074"),p=o("9c40"),h=o("b047"),g=o("eebe"),m=o.n(g),b=Object(c["a"])(l,s,a,!1,null,null,null);e["a"]=b.exports;m()(b,"components",{QSelect:r["a"],QItem:d["a"],QItemSection:u["a"],QBtn:p["a"],QChip:h["a"]})},c738:function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-page",{attrs:{padding:""}},[o("q-header",{staticClass:"bg-darkl1",attrs:{elevated:""}},[o("div",{staticClass:"q-py-sm text-uppercase row items-center"},[o("q-btn",{attrs:{flat:"",icon:"fas fa-chevron-left",color:"white"},on:{click:function(e){return t.$router.push("/almacen/contador")}}}),o("span",{staticClass:"text-light-blue-13"},[t._v(" Configuracion de Inventario "+t._s(this.$route.params.id))])],1)]),t.data?[o("q-card",{staticClass:"q-mt-xs bg-darkl1 exo"},[o("q-card-section",[t._v("\n                Creacion: "+t._s(t.data.inventory.created_at)),o("br"),t._v("\n                Administrador: "+t._s(t.data.inventory.created_by.names)+" "+t._s(t.data.inventory.created_by.surname_pat)+" [ "+t._s(t.data.inventory.created_by.nick)+" ]"),o("br")])],1),o("div",{class:t.wrapperClass+" q-pt-md q-mb-xl q-gutter-md"},[o("q-card",{staticClass:"col bg-darkl1 exo"},[o("q-expansion-item",{attrs:{"expand-separator":"",icon:"fas fa-users",label:"Responsables",caption:t.group.length.toString(),"header-class":"text-grey-5"},model:{value:t.expands.respos,callback:function(e){t.$set(t.expands,"respos",e)},expression:"expands.respos"}},[o("q-card-section",[o("q-list",t._l(t.natAccounts,(function(e){return o("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.id,attrs:{tag:"label"}},[o("q-item-section",{attrs:{avatar:""}},[o("q-checkbox",{attrs:{disable:1!=t.data.inventory.status.id,dark:"",val:e.id,color:"green-13"},on:{input:function(o){return t.toggleReponsable(e.id)}},model:{value:t.group,callback:function(e){t.group=e},expression:"group"}})],1),o("q-item-section",[o("q-item-label",[o("span",{staticClass:"text-grey-6"},[t._v(t._s(e.names+" "+e.surname_pat))]),o("br"),t._v("\n                                        [ "+t._s(e.nick.toLowerCase())+" ]\n                                    ")])],1)],1)})),1)],1)],1)],1),o("q-card",{staticClass:"col bg-darkl1 exo"},[o("q-expansion-item",{attrs:{"expand-separator":"",icon:"fas fa-boxes",label:"Productos",caption:t.listProducts.length.toString(),"header-class":"text-grey-5"},model:{value:t.expands.products,callback:function(e){t.$set(t.expands,"products",e)},expression:"expands.products"}},[o("q-card-section",[o("div",{staticClass:"row items-start"},[1==t.data.inventory.status.id?o("div",{staticClass:"col"},[o("q-select",{attrs:{dark:"",dense:"",flat:"",color:"green-13",label:"Agregar por...","stack-label":"",options:t.optsAddProds},on:{input:t.modeAddChanged},model:{value:t.modeAdd,callback:function(e){t.modeAdd=e},expression:"modeAdd"}})],1):t._e()])]),t.modeAdd?o("q-card-section",[1==t.modeAdd.value?o("CategoriesBrowser",{on:{selectedCat:t.selectedCat}}):t._e(),2==t.modeAdd.value?o("WarehousesBrowser",{on:{selectedLoc:t.selectedLoc}}):t._e(),3==t.modeAdd.value?o("div",[o("ProductAutocomplete")],1):t._e()],1):t._e(),o("q-card-section",{staticStyle:{"max-width":"100%"}},[o("q-table",{attrs:{dark:"",flat:"","card-class":"bg-none",data:t.listProducts,columns:t.tableProducts.columns,"visible-columns":t.tableProducts.visibleColumns},scopedSlots:t._u([{key:"body",fn:function(e){return[o("q-tr",{attrs:{props:e}},[o("q-td",{key:"id",attrs:{props:e}},[t._v(t._s(e.row.id))]),o("q-td",{key:"code",attrs:{props:e}},[t._v(t._s(e.row.code))]),o("q-td",{key:"description",staticClass:"text--2",attrs:{props:e}},[t._v(t._s(e.row.description))]),o("q-td",{key:"locations",attrs:{props:e}},[t._v("\n                                        [ "+t._s(e.row.locations.length)+" ]\n                                        "),t._l(e.row.locations,(function(e,s){return o("span",{key:s},[t._v(t._s(e.path))])}))],2)],1)]}}],null,!1,3869234322)})],1)],1)],1)],1)]:t._e(),o("q-page-sticky",{attrs:{position:"bottom-left",offset:[10,10]}},[t.trydiscard?[o("q-btn",{attrs:{rounded:"","no-caps":"",color:"primary",icon:"close",label:"No Eliminar"},on:{click:function(e){t.trydiscard=!1}}}),o("q-btn",{attrs:{rounded:"","no-caps":"",color:"negative",label:"¡Confirmar Eliminacion de Inventario!"},on:{click:function(e){return t.nextStep(4)}}})]:o("q-btn",{attrs:{rounded:"","no-caps":"",color:"orange-14",icon:"delete",label:"Eliminar"},on:{click:function(e){t.trydiscard=!0}}})],2),t.canStart&&!t.trydiscard?o("q-page-sticky",{attrs:{position:"bottom-right",offset:[10,10]}},[o("q-btn",{attrs:{rounded:"","no-caps":"",color:"primary",icon:"fas fa-play-circle",label:"Iniciar"},on:{click:t.start}})],1):t._e()],2)},a=[],n=(o("e01a"),o("e6cf"),o("e0df")),i=o("31b8"),l={join(t){return i["b"].get("/workpoint/join")},get(t){return i["b"].post("account/users",t)}},c=o("b293"),r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"row items-end"},[o("q-select",{staticClass:"col-3 q-mr-sm q-mb-sm",attrs:{dark:"",color:"green-13","option-value":"id","option-label":"name",label:"Categoria",options:t.categories.options},on:{input:t.setRootCat},model:{value:t.categories.selected,callback:function(e){t.$set(t.categories,"selected",e)},expression:"categories.selected"}}),t._l(t.categories.children,(function(e,s){return o("q-select",{key:s,staticClass:"col-3 q-mr-sm q-mb-sm",attrs:{dark:"",color:"green-13",label:"Seleccione",options:t.categories.children[s].options,"option-value":"id","option-label":"name"},on:{input:function(e){return t.loadCats(t.categories.children[s].model,s)}},model:{value:t.categories.children[s].model.value,callback:function(e){t.$set(t.categories.children[s].model,"value",e)},expression:"categories.children[idx].model.value"}})})),o("q-inner-loading",{attrs:{showing:t.loading.state,dark:""}},[o("q-spinner-dots",{attrs:{size:"30px",color:"amber-7"}})],1)],2)},d=[],u=(o("a434"),o("f7cb")),p={props:{fetchproducts:{type:Boolean,default:!0}},data(){return{categories:{selected:null,options:[],children:[]},loading:{state:!1,msg:""},filters:{paginate:null,_category:null,_location:null,check_stock:!1,with_stock:!1,_status:null,check_locations:!0},labeloading:""}},async mounted(){this.loading.state=!0;let t={_category:null,products:!1};this.categories.options=await u["a"].categories(t),console.log(this.categories.options),this.loading.state=!1},methods:{async setRootCat(){this.loading.state=!0,this.categories.children=[];let t={_category:this.categories.selected.id},e=await u["a"].categories(t);if(e.children.length){let t={options:e.children,model:{label:"Seleccione",value:null}};this.categories.children.push(t)}this.selectedCat(this.categories.selected)},async loadCats(t,e){this.loading.state=!0,this.categories.children.splice(e+1);let o={_category:t.value.id},s=await u["a"].categories(o);if(s.children.length){let t={options:s.children,model:{label:"Seleccione",value:null}};this.categories.children.push(t)}this.selectedCat(t.value)},async selectedCat(t){this.filters._category=t.id;let e={category:t,products:[]};this.fetchproducts&&t.root&&(e.products=await u["a"].get(this.filters)),this.loading.state=!1,this.$emit("selectedCat",e)}}},h=p,g=o("2877"),m=o("ddd8"),b=o("74f7"),f=o("8380"),v=o("eebe"),y=o.n(v),_=Object(g["a"])(h,r,d,!1,null,null,null),w=_.exports;y()(_,"components",{QSelect:m["a"],QInnerLoading:b["a"],QSpinnerDots:f["a"]});var x=o("a647"),k={components:{ProductAutocomplete:c["a"],CategoriesBrowser:w,WarehousesBrowser:x["a"]},data(){return{data:null,natAccounts:null,trydiscard:!1,group:[],optsAddProds:[{label:"Categoria",value:1},{label:"Ubicacion",value:2}],modeAdd:null,listProducts:[],tableProducts:{columns:[{name:"id",align:"left",label:"ID",field:t=>t.id,sortable:!0},{name:"code",align:"left",label:"Codigo",field:t=>t.code,sortable:!0},{name:"description",align:"left",label:"Descripcion",field:t=>t.description},{name:"locations",align:"center",label:"Ubicaciones",field:t=>t.locations.length,sortable:!0}],visibleColumns:["code","locations"]},expands:{respos:!0,products:!0},settings:new Object}},async beforeMount(){this.$store.commit("Layout/hideToolbarModule"),this.data=await n["a"].find(this.$route.params.id),console.log(this.data),this.listProducts=this.data.inventory.products,this.getAccounts()},methods:{getAccounts(){l.get({_rol:[7]}).then((t=>{console.log(t.data),this.natAccounts=t.data.map((t=>(this.data.inventory.responsables.forEach((e=>{e.id==t.id&&this.group.push(t.id)})),t)))})).catch((t=>{console.log(t)}))},toggleReponsable(t){let e={_responsable:t,_inventory:this.$route.params.id};n["a"].toggleReponsable(e).then((t=>{console.log(t.data),console.log(this.group)})).catch((t=>{console.log(t)}))},selectedCat(t){console.log("Categoria Seleccionada"),this.settings.category=t.category,this.listProducts=t.products.length?t.products:[],console.log(this.settings)},selectedLoc(t){console.log("Ubicacion seleccionada"),this.settings.warehouse=t.warehouse,this.settings.section=t.section?t.section.model.value:null,this.listProducts=t.products.length?t.products:[]},async modeAddChanged(){this.settings=new Object,this.listProducts=[],this.settings.addmode=this.modeAdd.value},start(){console.log("Iniciando ");let t=this.listProducts.map((t=>t.id)),e={_products:t,_inventory:this.data.inventory.id,settings:this.settings};this.$q.loading.show({message:"Aplicando configuracion, porfavor espera..."}),n["a"].addProducts(e).then((t=>{this.nextStep()})).catch((t=>{console.log(t)}))},nextStep(t,e){let o=this.data.inventory.status,s="";console.log("Estatus Actual: "+o.id);let a=t||o.id+1;switch(a){case 2:s="Iniciando Inventario, espera...";break;case 3:s="Cerrando Inventario, esperaa..";break;case 4:s="Eliminando Inventario, espera...";break}this.$q.loading.show({message:s});let i={_inventory:this.data.inventory.id,_status:a};console.log("Cambiando status"),console.log(i),n["a"].nextStep(i).then((t=>{let e=t.data;console.log(e),this.data.inventory.status=e.order.status,this.notifyChangeState(e),this.$q.loading.hide()})).catch((t=>{console.log(t)}))},notifyChangeState(t){let e=t.order.status.id;switch(e){case 2:this.$q.notify({icon:"done",color:"positive",message:"El inventario ya puede realizarse!!",timeout:1200}),this.$q.loading.show(),setTimeout((()=>{this.$router.push("/almacen/contador/"+t.order.id),this.$q.loading.hide()}),1500);break;case 3:msgnewState="Cerrando Inventario, esperaa..";break;case 4:this.$q.notify({icon:"done",color:"positive",message:"El inventario ha sido eliminado!"}),this.$router.push("/almacen/contador");break}}},beforeDestroy(){this.$store.commit("Layout/showToolbarModule")},computed:{fullpath(){let t="";return this.warehouses.sectModels.forEach(((e,o,s)=>{e.value&&(t+=0==o?""+e.label:"-"+e.label)})),t},auths(){return this.$store.getters["Account/moduleauths"]},profile(){return this.$store.getters["Account/profile"]},canStart(){return this.listProducts.length&&this.group.length},wrapperClass(){return this.$q.platform.is.mobile?"column":"row items-start"}}},q=k,C=o("9989"),S=o("e359"),$=o("9c40"),A=o("f09f"),Q=o("a370"),I=o("3b73"),P=o("1c1c"),E=o("66e5"),L=o("4074"),R=o("8f8e"),B=o("0016"),O=o("0170"),j=o("eaac"),M=o("bd08"),T=o("db86"),z=o("de5e"),D=o("714f"),W=Object(g["a"])(q,s,a,!1,null,null,null);e["default"]=W.exports;y()(W,"components",{QPage:C["a"],QHeader:S["a"],QBtn:$["a"],QCard:A["a"],QCardSection:Q["a"],QExpansionItem:I["a"],QList:P["a"],QItem:E["a"],QItemSection:L["a"],QCheckbox:R["a"],QIcon:B["a"],QItemLabel:O["a"],QSelect:m["a"],QTable:j["a"],QTr:M["a"],QTd:T["a"],QPageSticky:z["a"]}),y()(W,"directives",{Ripple:D["a"]})},e0df:function(t,e,o){"use strict";var s=o("31b8");e["a"]={index(){return s["b"].get("inventory").then((t=>t.data)).catch((t=>{console.log(t)}))},find(t){return s["b"].get("inventory/"+t).then((t=>t.data)).catch((t=>{console.log(t)}))},create(t){return s["b"].post("inventory",t)},toggleReponsable(t){return s["b"].post("inventory/responsable",t)},addProducts(t){return s["b"].post("inventory/add",t)},nextStep(t){return s["b"].post("inventory/next",t)},rowCount(t){return s["b"].post("inventory/value",t)}}},f7cb:function(t,e,o){"use strict";var s=o("31b8");e["a"]={autocomplete(t){return s["b"].get("/product/autocomplete",t)},getMassive(t){return s["b"].post("/product/getMassive",t)},labelStates(){return s["b"].get("/product/getStatus").then((t=>t.data.status)).catch((t=>{console.log(t)}))},updateState(t){return s["b"].post("/product/updateStatus",t)},listPoducts(t){return s["b"].post("product",t)},categories(t){return s["b"].post("/product/catalog",t).then((t=>t.data.categories)).catch((t=>{console.log(t)}))},get(t){return s["b"].post("/product",t).then((t=>t.data)).catch((t=>{console.log(t)}))}}}}]);