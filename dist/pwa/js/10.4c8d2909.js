(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"5b0e":function(t,e,s){"use strict";s("8893")},8893:function(t,e,s){},cc6a:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-layout",{attrs:{view:"lHh Lpr lFf"}},[s("q-page-container",{staticClass:"exo bg-darkl0 text-white"},[t.layout.header.state?s("q-header",{staticClass:"bg-none"},[s("q-card",{staticClass:"bg-darkl1"},[s("HeaderApp",{attrs:{title:t.layout.header.title}}),t.layout.viewsection?s("div",{staticClass:"bg-darkl1 q-pa-sm row"},[s("div",{staticClass:"col-md col-xs-12"},[s("RangeDates",{on:{inputRanges:t.loadView}})],1)]):t._e()],1)],1):t._e(),s("router-view"),t.layout.footer.state?s("q-footer",{staticClass:"bg-darktransl0",attrs:{reveal:""}},[s("ToolbarModule",{attrs:{with_home:t.inc_home}})],1):t._e()],1)],1)},o=[],i=s("b0fc"),r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"col-md col-xs-12 row items-end",class:t.$q.screen.lt.md?"justify-between":"justify-end"},[s("q-select",{attrs:{dark:"",color:"green-13",label:"Vista",options:t.selectViews.opts},on:{input:t.setDates},model:{value:t.selectViews.selected,callback:function(e){t.$set(t.selectViews,"selected",e)},expression:"selectViews.selected"}}),s("div",{staticClass:"q-pl-md"},["c"==t.selectViews.selected.value?[s("q-btn",{attrs:{rounded:"",color:"primary",icon:"fas fa-calendar-day","no-caps":""}},[s("q-popup-proxy",[s("q-card",{staticClass:"bg-darkl1 text-grey-5 exo"},[s("q-card-section",[t._v("Seleccione periodo")]),s("q-tabs",{staticClass:"bg-dark text-white shadow-2",attrs:{align:"justify",breakpoint:0},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[s("q-tab",{attrs:{name:"f",label:this.ranges.date.from+" "+this.ranges.time.from,"no-caps":""}}),s("q-tab",{attrs:{name:"t",label:this.ranges.date.to+" "+this.ranges.time.to,"no-caps":""}})],1),s("q-tab-panels",{staticClass:"text-center bg-darkl1",attrs:{animated:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[s("q-tab-panel",{attrs:{name:"f"}},[s("q-date",{attrs:{minimal:"",flat:"",dark:""},model:{value:this.ranges.date.from,callback:function(e){t.$set(this.ranges.date,"from",e)},expression:"this.ranges.date.from"}}),s("div",{staticClass:"text-left q-pt-md"},[s("div",{staticClass:"row items-center"},[s("span",{staticClass:"col-3"},[t._v("Hora:")]),s("q-slider",{staticClass:"col",attrs:{label:"",min:8,max:23},model:{value:t.times.from.h,callback:function(e){t.$set(t.times.from,"h",e)},expression:"times.from.h"}}),s("span",{staticClass:"col-2 text-right"},[t._v(t._s(t.times.from.h))])],1),s("div",{staticClass:"row items-center"},[s("span",{staticClass:"col-3"},[t._v("Minuto:")]),s("q-slider",{staticClass:"col",attrs:{label:"",min:0,max:59,step:10},model:{value:t.times.from.m,callback:function(e){t.$set(t.times.from,"m",e)},expression:"times.from.m"}}),s("span",{staticClass:"col-2 text-right"},[t._v(t._s(t.times.from.m))])],1)])],1),s("q-tab-panel",{attrs:{name:"t"}},[s("q-date",{attrs:{minimal:"",flat:"",dark:""},model:{value:this.ranges.date.to,callback:function(e){t.$set(this.ranges.date,"to",e)},expression:"this.ranges.date.to"}}),s("div",{staticClass:"text-left q-pt-md"},[s("div",{staticClass:"row items-center"},[s("span",{staticClass:"col-3"},[t._v("Hora:")]),s("q-slider",{staticClass:"col",attrs:{label:"",min:9,max:23},model:{value:t.times.to.h,callback:function(e){t.$set(t.times.to,"h",e)},expression:"times.to.h"}}),s("span",{staticClass:"col-2 text-right"},[t._v(t._s(t.times.to.h))])],1),s("div",{staticClass:"row items-center"},[s("span",{staticClass:"col-3"},[t._v("Minuto:")]),s("q-slider",{staticClass:"col",attrs:{label:"",min:0,max:59,step:10},model:{value:t.times.to.m,callback:function(e){t.$set(t.times.to,"m",e)},expression:"times.to.m"}}),s("span",{staticClass:"col-2 text-right"},[t._v(t._s(t.times.to.m))])],1)])],1)],1),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"OK"}})],1)],1)],1)],1)]:[s("div",{staticClass:"row q-gutter-md"},[s("div",{staticClass:"text-right"},[s("div",{staticClass:"text--1 text-grey-3"},[t._v(t._s(this.ranges.date.display.from))]),s("div",{staticClass:"text--2"},[t._v(t._s(this.ranges.time.display.from))])]),s("div",{staticClass:"text-right"},[s("div",{staticClass:"text--1 text-grey-3"},[t._v(t._s(this.ranges.date.display.to))]),s("div",{staticClass:"text--2"},[t._v(t._s(this.ranges.time.display.to))])])])]],2)],1)},n=[],l={name:"RangeDates",props:{label:{type:String,default:"Vista"},useTime:{type:Boolean,default:!1}},data(){return{selectViews:{opts:[{label:"Diaria",value:"t"},{label:"Semanal",value:"w"},{label:"Mensual",value:"m"},{label:"Anual",value:"y"},{label:"Personalizada",value:"c",disable:!0}],selected:{label:"Diaria",value:"t"}},ranges:{date:{from:null,to:null,display:{from:null,to:null}},time:{from:null,to:null,display:{from:null,to:null}}},tab:"f",times:{from:{h:9,m:0},to:{h:9,m:0}}}},beforeMount(){this.setDates()},methods:{setDates(){let t=this.selectViews.selected,e=this.$moment(),s=!0;switch(t.value){case"w":this.ranges.date.from=e.startOf("week").format("YYYY-MM-DD"),this.ranges.date.display.from=e.startOf("week").format("YYYY/MM/DD");break;case"m":this.ranges.date.from=e.startOf("month").format("YYYY-MM-DD"),this.ranges.date.display.from=e.startOf("month").format("YYYY/MM/DD");break;case"y":this.ranges.date.from=e.startOf("year").format("YYYY-MM-DD"),this.ranges.date.display.from=e.startOf("year").format("YYYY/MM/DD");break;case"c":console.log("Esperando rango de fechas..."),s=!1;break;default:this.ranges.date.from=this.$moment().format("YYYY-MM-DD"),this.ranges.date.to=this.$moment().format("YYYY-MM-DD"),this.ranges.time.from=this.$moment().startOf("day").add(8,"h").format("HH:mm:ss"),this.ranges.time.to=this.$moment().endOf("day").format("HH:mm:ss"),this.ranges.date.display.from=this.$moment().format("YYYY/MM/DD"),this.ranges.date.display.to=this.$moment().format("YYYY/MM/DD"),this.ranges.time.display.from=this.$moment().startOf("day").add(8,"h").format("hh:mm a"),this.ranges.time.display.to=this.$moment().endOf("day").format("hh:mm a");break}s&&this.$emit("inputRanges",{ranges:this.ranges,option:this.selectViews.selected,dbranges:this.dbranges})}},computed:{dbranges(){return{from:`${this.ranges.date.from} ${this.ranges.time.from}`,to:`${this.ranges.date.to} ${this.ranges.time.to}`}}}},c=l,d=s("2877"),m=s("ddd8"),p=s("9c40"),h=s("7cbe"),u=s("f09f"),f=s("a370"),g=s("429b"),b=s("7460"),k=s("adad"),v=s("823b"),w=s("52ee"),x=s("c1d0"),$=s("4b7e"),y=s("7f67"),C=s("eebe"),_=s.n(C),q=Object(d["a"])(c,r,n,!1,null,null,null),Y=q.exports;_()(q,"components",{QSelect:m["a"],QBtn:p["a"],QPopupProxy:h["a"],QCard:u["a"],QCardSection:f["a"],QTabs:g["a"],QTab:b["a"],QTabPanels:k["a"],QTabPanel:v["a"],QDate:w["a"],QSlider:x["a"],QCardActions:$["a"]}),_()(q,"directives",{ClosePopup:y["a"]});var D=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"q-pa-sm row items-center"},[s("div",{staticClass:"col text-ledt"},[s("q-btn",{attrs:{dense:"",rounded:"",flat:"",icon:"fab fa-atlassian fa-rotate-180"},on:{click:function(e){return t.$router.push("/")}}})],1),s("div",{staticClass:"col text-center"},[s("div",[t._v(t._s(t.workin.workpoint.alias))]),s("div",{staticClass:"text--2 text-grey-5"},[t._v(t._s(t.title))])]),s("div",{staticClass:"col text-right"},[s("q-btn",{attrs:{rounded:"",dense:"",color:t.vsocket.connected?"green-13":""}},[s("q-img",{staticStyle:{height:"30px",width:"30px"},attrs:{src:t.picnick,"spinner-color":"white"}}),s("q-menu",{attrs:{dark:"","transition-show":"flip-right","transition-hide":"flip-left"}},[s("q-list",{staticClass:"exo text-grey-6",staticStyle:{"min-width":"150px"}},[s("q-item",{attrs:{clickable:""},on:{click:function(e){return t.$router.push("/perfil")}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"fas fa-user-astronaut"}})],1),s("q-item-section",{staticClass:"text-green-13"},[t._v(t._s(t.profile.me.nick))])],1),s("q-separator"),s("q-item",{attrs:{clickable:""},on:{click:t.sessionDestroy}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"meeting_room"}})],1),s("q-item-section",[t._v("Salir")])],1)],1)],1)],1)],1)])},M=[],O={name:"HeaderApp",props:{title:{type:String,default:""}},data(){return{vsocket:!1}},mounted(){this.vsocket=this.$vSocket},methods:{sessionDestroy(){this.$store.commit("Account/unsetsession"),this.$router.push("/acceso")}},computed:{profile:{get(){return this.$store.state.Account.profile}},workin:{get(){return this.$store.state.Account.workin}},picnick(){return this.profile.me.pictures?this.session.me.pictures:"https://image.flaticon.com/icons/png/512/2835/2835180.png"}}},Q=O,A=s("068f"),S=s("4e73"),P=s("1c1c"),V=s("66e5"),j=s("4074"),H=s("0016"),U=s("eb85"),T=Object(d["a"])(Q,D,M,!1,null,null,null),I=T.exports;_()(T,"components",{QBtn:p["a"],QImg:A["a"],QMenu:S["a"],QList:P["a"],QItem:V["a"],QItemSection:j["a"],QIcon:H["a"],QSeparator:U["a"]});var J=s("5542"),B=s("c4e4"),R={name:"Preventa",components:{ToolbarModule:i["a"],RangeDates:Y,HeaderApp:I},data(){return{psocket:this.$sktPreventa}},created(){this.psocket.disconnect(),this.psocket.connect(),this.psocket.on("socketid",(t=>this.sktId(t))),this.psocket.on("joinedat",(t=>this.sktJoinedAt(t))),this.psocket.on("newjoin",(t=>this.sktNewJoin(t))),this.psocket.on("order_add",(t=>this.sktOrderAdd(t))),this.psocket.on("order_update",(t=>this.sktOrderUpdate(t))),this.psocket.on("order_aou",(t=>this.sktAOU(t))),this.psocket.on("module_update",(t=>this.sktModuleUpdate(t))),this.psocket.on("cash_update",(t=>this.sktCashUpdate(t)));let t=null;switch(this.profile.me._rol){case 1:case 2:case 3:t="admins";break;case 4:t="sales";break;case 6:case 7:t="supply";break;case 9:t="checkout";break}this.psocket.emit("join",{profile:this.profile,workpoint:this.workin.workpoint,room:t}),this.psocket.emit("join",{profile:this.profile,workpoint:this.workin.workpoint,room:"cfg"})},methods:{async loadView(t){this.$q.loading.show({message:"Cargando vista..."});let e={date_from:t.dbranges.from,date_to:t.dbranges.to},s=await J["a"].index(e);console.log(s);let a=await B["a"].get({_rol:[4]});this.$store.commit("Preventa/startState",{index:s,agents:a}),this.$q.loading.hide()},sktId(t){console.log(`%cidSktPreventa: ${t}`,"background:#273c75;color:#f5f6fa;border-radius:10px;padding:10px;font-size:1.3em;")},sktJoinedAt(t){console.log(`%cUnion a ${t.room} OK!!`,"background:#3d3d3d;color:#3ae374;border-radius:10px;padding:10px;")},sktNewJoin(t){console.log(`%c${t.profile.me.nick} se unio a ${t.room}`,"background:#3ae374;color:#3d3d3d;border-radius:10px;padding:10px;"),console.log(t)},sktOrderAdd(t){console.log(t);let e=t.order,s=t.user.me;console.log(`%c${s.nick} inicio la orden ${e.id}`,"background:#303952;color:#e66767;border-radius:10px;padding:8px;"),console.log(t),this.$store.commit("Preventa/newOrder",e)},sktOrderUpdate(t){let e=t.order,s=t.newstate;console.log(`%cLa orden ${t.order.id} cambio su status a ${t.newstate.name}`,"background:#7158e2;color:#fffa65;border-radius:10px;padding:8px;"),this.$store.commit("Preventa/updateState",{order:e,newstate:s})},sktModuleUpdate({by:t,_msgstate:e,state:s}){this.$store.commit("Preventa/setState",s),console.log(`%c--❯ ${t} ${e} el modulo ${s.name}`,"background:#fbc531;color:#2f3640;border-radius:10px;padding:10px;font-size:1.3em;"),this.appsounds.alert1.play(),this.$q.notify({message:`${t} <b>${e}</b> el modulo <b>${s.name}</b>`,type:"warning",closeBtn:"Ok",timeout:1e4,position:"center",html:!0})},sktAOU(t){console.log(t),console.log(`%cAveriguando existencia de pedido ${t.order.id} para crear o actualizar!!`),this.$store.commit("Preventa/orderAOU",t)},sktCashUpdate({by:t,cash:e,newstate:s}){let a=1==s.id?"encendio":"apago";this.$store.commit("Preventa/setCashState",{cash:e,newstate:s}),this.$q.notify({message:`<b>${t}</b> ${a} la <b>${e.name}</b>`,type:"warning",closeBtn:"Ok",timeout:1e4,position:"center",html:!0})}},destroyed(){console.log("%cDesconectando de preventa...","background:#F97F51;color:#2C3A47;border-radius:10px;padding:6px;"),this.psocket.emit("unjoin",{profile:this.profile,workpoint:this.workin.workpoint,room:"admins"}),this.psocket.off("admins"),this.psocket.off("orders"),this.psocket.disconnect()},computed:{workin(){return this.$store.getters["Account/workin"]},profile(){return this.$store.getters["Account/profile"]},layout(){return this.$store.state.Preventa.layout},inc_home(){return this.profile.me._rol<=3},appsounds(){return this.$store.getters["Multimediapp/sounds"]}}},z=R,E=(s("5b0e"),s("4d5a")),F=s("09e3"),L=s("e359"),N=s("7ff0"),K=Object(d["a"])(z,a,o,!1,null,null,null);e["default"]=K.exports;_()(K,"components",{QLayout:E["a"],QPageContainer:F["a"],QHeader:L["a"],QCard:u["a"],QFooter:N["a"]})}}]);