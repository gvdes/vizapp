(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[23],{"0694":function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-page",[r("q-header",{staticClass:"bg-darkl0 text-grey-5"},[r("q-card",{staticClass:"bg-darkl1"},[r("toolbar-account",{attrs:{title:"Preventa"}}),r("div",{staticClass:"q-pa-md row justify-between"},[r("div",{staticClass:"ds"},[t._v("sdf")]),r("div",{staticClass:"ds"},[t._v("sdfsdf")])])],1)],1),r("div",{staticClass:"row q-ma-md items-start"},[r("div",{staticClass:"col q-pa-sm"},[r("q-card",{staticClass:"bg-darkl1"},[r("q-card-section",[t._v("\n\t\t\t\t\t\tResumen\n\t\t\t\t\t")]),r("q-card-section")],1)],1),r("div",{staticClass:"col q-pa-sm"},[r("q-card",{staticClass:"bg-darkl1"},[r("q-card-section",{attrs:{horizontal:""}},[r("q-card-section",[t._v("sdfsf")]),r("q-separator"),r("q-card-section",[t._v("sdfsdf")])],1),r("q-card-section",[r("q-table",{attrs:{data:t.orders_db,"row-key":"id",dark:"",filter:t.tableorders.filtrator,"card-class":"q-pa-sm bg-none text-grey-6",columns:t.tableorders.columns,flat:""},scopedSlots:t._u([t.orders_db.length?{key:"top-right",fn:function(){return[r("q-input",{attrs:{color:"green-13",dark:"",dense:"",debounce:"0",placeholder:"Buscar (folio o nombre)"},scopedSlots:t._u([{key:"append",fn:function(){return[r("q-icon",{attrs:{name:"search"}})]},proxy:!0}],null,!1,4009527860),model:{value:t.tableorders.filtrator,callback:function(e){t.$set(t.tableorders,"filtrator",e)},expression:"tableorders.filtrator"}})]},proxy:!0}:null,{key:"body",fn:function(e){return[r("q-tr",{attrs:{props:e},on:{click:function(r){return t.open(e.row.id)}}},[r("q-td",{key:"id",attrs:{props:e}},[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(e.row.id)+"\n\t\t\t\t\t\t\t\t\t")]),r("q-td",{key:"client",attrs:{props:e}},[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(e.row.name)+"\n\t\t\t\t\t\t\t\t\t")]),r("q-td",{key:"timed",attrs:{props:e}},[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(t.humantime(e.row.created_at))+"\n\t\t\t\t\t\t\t\t\t")])],1)]}}],null,!0)})],1)],1)],1)]),r("q-dialog",{attrs:{position:"bottom"},model:{value:t.windCreate.state,callback:function(e){t.$set(t.windCreate,"state",e)},expression:"windCreate.state"}},[r("q-card",{staticClass:"bg-darkl0 exo text-grey-5"},[r("q-form",[r("q-toolbar",[t._v("Nuevo Pedido")]),r("q-card-section",[r("div",{staticClass:"row items-end q-gutter-sm"},[r("q-input",{staticClass:"col",attrs:{dark:"",label:"Cliente",color:"green-13",autofocus:""},model:{value:t.windCreate.ipt.client,callback:function(e){t.$set(t.windCreate.ipt,"client",e)},expression:"windCreate.ipt.client"}}),t.cancreate?r("q-btn",{attrs:{flat:"",rounded:"",type:"submit",icon:"done",color:"green-13",disable:t.windCreate.ipt.load,loading:t.windCreate.ipt.load},on:{click:t.tryCreate}}):t._e()],1)])],1)],1)],1),r("q-page-sticky",{attrs:{position:"bottom-right",offset:[10,3]}},[r("q-btn",{staticClass:"bg-darkl1 shadow-1",attrs:{rounded:"",flat:"",color:"green-13",icon:"add"},on:{click:function(e){t.windCreate.state=!0}}})],1)],1)},s=[],a=(r("e6cf"),r("8e27")),i=r.n(a),n=r("1321"),d=r.n(n),l=r("bd4c"),c=r("1d6c"),p=r("31b8"),u={autocomplete(t){return p["b"].get("/product/autocomplete",t)},create(t){return p["b"].post("/order",t)},index(){return p["b"].get("/order").then((t=>{let e=t.data;return e})).catch((t=>{console.log(t)}))}},h={components:{apexchart:d.a,ToolbarAccount:c["a"]},data(){return{orders_chart:{options:{chart:{id:"orders_chart",background:"none"},stroke:{colors:["#2D3035"]},theme:{palette:"palette8",mode:"dark"},labels:["En captura","Por surtir","Surtiendo","Cobrados","Completados"],colors:["#ced6e0","#fa8231","#1e90ff","#4cd137","#eb3b5a"]}},windCreate:{state:!1,ipt:{dis:!0,load:!1,client:""}},index:void 0,tableorders:{columns:[{name:"id",align:"left",label:"Folio",field:"id"},{name:"client",align:"left",label:"Cliente",field:"name",sortable:!0},{name:"timed",align:"center",label:"Hora",field:"created_at",sortable:!0}],filtrator:""},sktprev:void 0}},async beforeMount(){this.index=await u.index(),console.log(this.workin),console.log("Conectando a SOCKET"),this.sktprev=await i()(`${this.$vsocket}/preventa`),this.sktprev.emit("index",this.profile),console.log(`Uniendo a ROOMs de preventa (${this.socketroom})`),this.sktprev.emit("joinat",{room:this.socketroom,user:this.profile}),this.sktprev.on("joinprev",(t=>{this.sktjoinprev(t)})),this.sktprev.on("joinprevwrh",(t=>{this.sktjoinprevwrh(t)}))},beforeDestroy(){console.log("desconectando del room"),this.sktprev.emit("leave",{room:this.socketroom,user:this.profile})},methods:{tryCreate(){this.sktprev.emit("order_creating",{room:this.socketroom,user:this.profile,order:null}),this.windCreate.ipt.load=!0;let t={name:this.windCreate.ipt.client};u.create(t).then((t=>{let e=t.data;console.log(e),this.sktprev.emit("order_created",{room:this.socketroom,user:this.profile,order:e}),this.$router.push(`/preventa/${e.id}`)})).catch((t=>{console.log(t)})),console.log(t)},open(t){this.$router.push(`/preventa/${t}`)},sktjoinprev(t){console.log(t)},sktjoinprevwrh(t){console.log(t)}},computed:{profile(){return this.$store.getters["Account/profile"]},workin(){return this.$store.getters["Account/workin"]},cancreate(){return this.windCreate.ipt.client.length>3},orders_db(){return this.index?this.index.orders:[]},orders_capture(){return this.orders_db.filter((t=>1==t.status.id))},orders_forsupply(){return this.orders_db.filter((t=>2==t.status.id))},orders_onsupply(){return this.orders_db.filter((t=>3==t.status.id))},orders_chargeds(){return this.orders_db.filter((t=>4==t.status.id))},orders_archive(){return this.orders_db.filter((t=>5==t.status.id))},series_chart(){return[this.orders_capture.length,this.orders_forsupply.length,this.orders_onsupply.length,this.orders_chargeds.length,this.orders_archive.length]},humantime(){return t=>{let e=Date.now(),r=Date.parse(t),o=l["b"].getDateDiff(e,r,"days");switch(o){case 0:return l["b"].formatDate(r,"hh:mm a");case 1:return"Ayer, "+l["b"].formatDate(r,"hh:mm a");default:return`Hace ${o} dias, `+l["b"].formatDate(r,"hh:mm a")}}},socketroom(){return`${this.workin.workpoint.alias}`}}},f=h,m=r("2877"),b=r("9989"),k=r("e359"),g=r("f09f"),v=r("a370"),_=r("eb85"),w=r("eaac"),C=r("27f9"),q=r("0016"),y=r("bd08"),x=r("db86"),Q=r("24e8"),$=r("0378"),D=r("65c6"),j=r("9c40"),S=r("de5e"),T=r("eebe"),P=r.n(T),A=Object(m["a"])(f,o,s,!1,null,null,null);e["default"]=A.exports;P()(A,"components",{QPage:b["a"],QHeader:k["a"],QCard:g["a"],QCardSection:v["a"],QSeparator:_["a"],QTable:w["a"],QInput:C["a"],QIcon:q["a"],QTr:y["a"],QTd:x["a"],QDialog:Q["a"],QForm:$["a"],QToolbar:D["a"],QBtn:j["a"],QPageSticky:S["a"]})}}]);